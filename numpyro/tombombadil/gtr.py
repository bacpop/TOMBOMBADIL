import numpy as np
from jax import jit
import jax.numpy as jnp

# Not used for now, see commented code in update_GTR
omega_mat = jnp.array([[0., 0., 1., 1., 1., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 1., 0., 1., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.]])

non_omega_mat = jnp.array(([[ 1.,  1., 0., 0., 0.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0., 0.,  1., 0.,  1.,  1.,  1., 0.,  1., 0.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0., 0.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1., 0., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0., 0., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1., 0., 0.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1., 0., 0.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
        0., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
        0., 0.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1., 0., 0.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0., 0., 0.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1., 0., 0.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1., 0., 0.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0., 0., 0.,  1.,  1.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.]]))

@jit
def diag_update(M, pimult):
    # Compute the diagonal
    index = jnp.arange(0, 61, 1, jnp.uint16)
    # I think this might be the same as
    # M += jnp.diag(jnp.einsum('ij,ij->i', M, pi_mult))
    # but check this doesn't add loads of zeros
    # check https://jax.readthedocs.io/en/latest/_autosummary/jax.lax.fori_loop.html
    for i in range(61):
        # M = M.at[i, i].set(-jnp.dot(M[i, :], pimult[i, :]))
        M = M.at[i, i].set(-jnp.dot(jnp.take(M, index), jnp.take(pimult, index)))
        index += 61 # or use lax.slice?
    return M

@jit
def build_GTR(alpha, beta, gamma, delta, epsilon, eta, omega, pimat, pimult):
    M = jnp.zeros((61, 61))

    M = M.at[0,1].set(eta)
    M = M.at[0,2].set(gamma * omega)
    M = M.at[0,3].set(epsilon * omega)
    M = M.at[0,4].set(eta * omega)
    M = M.at[0,8].set(gamma * omega)
    M = M.at[0,10].set(epsilon * omega)
    M = M.at[0,13].set(eta * omega)
    M = M.at[0,29].set(gamma * omega)
    M = M.at[0,45].set(epsilon * omega)
    M = M.at[1,0].set(eta)
    M = M.at[1,2].set(beta * omega)
    M = M.at[1,3].set(delta * omega)
    M = M.at[1,5].set(eta * omega)
    M = M.at[1,9].set(gamma * omega)
    M = M.at[1,11].set(epsilon * omega)
    M = M.at[1,14].set(eta * omega)
    M = M.at[1,30].set(gamma * omega)
    M = M.at[1,46].set(epsilon * omega)
    M = M.at[2,0].set(gamma * omega)
    M = M.at[2,1].set(beta * omega)
    M = M.at[2,3].set(alpha)
    M = M.at[2,6].set(eta * omega)
    M = M.at[2,15].set(eta)
    M = M.at[2,31].set(gamma * omega)
    M = M.at[2,47].set(epsilon * omega)
    M = M.at[3,0].set(epsilon * omega)
    M = M.at[3,1].set(delta * omega)
    M = M.at[3,2].set(alpha)
    M = M.at[3,7].set(eta * omega)
    M = M.at[3,12].set(epsilon * omega)
    M = M.at[3,16].set(eta)
    M = M.at[3,32].set(gamma * omega)
    M = M.at[3,48].set(epsilon * omega)
    M = M.at[4,0].set(eta * omega)
    M = M.at[4,5].set(eta)
    M = M.at[4,6].set(gamma)
    M = M.at[4,7].set(epsilon)
    M = M.at[4,8].set(beta * omega)
    M = M.at[4,10].set(delta * omega)
    M = M.at[4,17].set(eta * omega)
    M = M.at[4,33].set(gamma * omega)
    M = M.at[4,49].set(epsilon * omega)
    M = M.at[5,1].set(eta * omega)
    M = M.at[5,4].set(eta)
    M = M.at[5,6].set(beta)
    M = M.at[5,7].set(delta)
    M = M.at[5,9].set(beta * omega)
    M = M.at[5,11].set(delta * omega)
    M = M.at[5,18].set(eta * omega)
    M = M.at[5,34].set(gamma * omega)
    M = M.at[5,50].set(epsilon * omega)
    M = M.at[6,2].set(eta * omega)
    M = M.at[6,4].set(gamma)
    M = M.at[6,5].set(beta)
    M = M.at[6,7].set(alpha)
    M = M.at[6,19].set(eta * omega)
    M = M.at[6,35].set(gamma * omega)
    M = M.at[6,51].set(epsilon * omega)
    M = M.at[7,3].set(eta * omega)
    M = M.at[7,4].set(epsilon)
    M = M.at[7,5].set(delta)
    M = M.at[7,6].set(alpha)
    M = M.at[7,12].set(delta * omega)
    M = M.at[7,20].set(eta * omega)
    M = M.at[7,36].set(gamma * omega)
    M = M.at[7,52].set(epsilon * omega)
    M = M.at[8,0].set(gamma * omega)
    M = M.at[8,4].set(beta * omega)
    M = M.at[8,9].set(eta)
    M = M.at[8,10].set(alpha * omega)
    M = M.at[8,21].set(eta * omega)
    M = M.at[8,37].set(gamma * omega)
    M = M.at[8,53].set(epsilon * omega)
    M = M.at[9,1].set(gamma * omega)
    M = M.at[9,5].set(beta * omega)
    M = M.at[9,8].set(eta)
    M = M.at[9,11].set(alpha * omega)
    M = M.at[9,22].set(eta * omega)
    M = M.at[9,38].set(gamma * omega)
    M = M.at[9,54].set(epsilon * omega)
    M = M.at[10,0].set(epsilon * omega)
    M = M.at[10,4].set(delta * omega)
    M = M.at[10,8].set(alpha * omega)
    M = M.at[10,11].set(eta)
    M = M.at[10,12].set(epsilon * omega)
    M = M.at[10,25].set(eta * omega)
    M = M.at[10,41].set(gamma * omega)
    M = M.at[10,57].set(epsilon * omega)
    M = M.at[11,1].set(epsilon * omega)
    M = M.at[11,5].set(delta * omega)
    M = M.at[11,9].set(alpha * omega)
    M = M.at[11,10].set(eta)
    M = M.at[11,12].set(delta * omega)
    M = M.at[11,26].set(eta * omega)
    M = M.at[11,42].set(gamma * omega)
    M = M.at[11,58].set(epsilon * omega)
    M = M.at[12,3].set(epsilon * omega)
    M = M.at[12,7].set(delta * omega)
    M = M.at[12,10].set(epsilon * omega)
    M = M.at[12,11].set(delta * omega)
    M = M.at[12,28].set(eta * omega)
    M = M.at[12,44].set(gamma * omega)
    M = M.at[12,60].set(epsilon * omega)
    M = M.at[13,0].set(eta * omega)
    M = M.at[13,14].set(eta)
    M = M.at[13,15].set(gamma)
    M = M.at[13,16].set(epsilon)
    M = M.at[13,17].set(eta * omega)
    M = M.at[13,21].set(gamma * omega)
    M = M.at[13,25].set(epsilon * omega)
    M = M.at[13,29].set(beta * omega)
    M = M.at[13,45].set(delta * omega)
    M = M.at[14,1].set(eta * omega)
    M = M.at[14,13].set(eta)
    M = M.at[14,15].set(beta)
    M = M.at[14,16].set(delta)
    M = M.at[14,18].set(eta * omega)
    M = M.at[14,22].set(gamma * omega)
    M = M.at[14,26].set(epsilon * omega)
    M = M.at[14,30].set(beta * omega)
    M = M.at[14,46].set(delta * omega)
    M = M.at[15,2].set(eta)
    M = M.at[15,13].set(gamma)
    M = M.at[15,14].set(beta)
    M = M.at[15,16].set(alpha)
    M = M.at[15,19].set(eta * omega)
    M = M.at[15,23].set(gamma * omega)
    M = M.at[15,27].set(epsilon * omega)
    M = M.at[15,31].set(beta * omega)
    M = M.at[15,47].set(delta * omega)
    M = M.at[16,3].set(eta)
    M = M.at[16,13].set(epsilon)
    M = M.at[16,14].set(delta)
    M = M.at[16,15].set(alpha)
    M = M.at[16,20].set(eta * omega)
    M = M.at[16,24].set(gamma * omega)
    M = M.at[16,28].set(epsilon * omega)
    M = M.at[16,32].set(beta * omega)
    M = M.at[16,48].set(delta * omega)
    M = M.at[17,4].set(eta * omega)
    M = M.at[17,13].set(eta * omega)
    M = M.at[17,18].set(eta)
    M = M.at[17,19].set(gamma)
    M = M.at[17,20].set(epsilon)
    M = M.at[17,21].set(beta * omega)
    M = M.at[17,25].set(delta * omega)
    M = M.at[17,33].set(beta * omega)
    M = M.at[17,49].set(delta * omega)
    M = M.at[18,5].set(eta * omega)
    M = M.at[18,14].set(eta * omega)
    M = M.at[18,17].set(eta)
    M = M.at[18,19].set(beta)
    M = M.at[18,20].set(delta)
    M = M.at[18,22].set(beta * omega)
    M = M.at[18,26].set(delta * omega)
    M = M.at[18,34].set(beta * omega)
    M = M.at[18,50].set(delta * omega)
    M = M.at[19,6].set(eta * omega)
    M = M.at[19,15].set(eta * omega)
    M = M.at[19,17].set(gamma)
    M = M.at[19,18].set(beta)
    M = M.at[19,20].set(alpha)
    M = M.at[19,23].set(beta * omega)
    M = M.at[19,27].set(delta * omega)
    M = M.at[19,35].set(beta * omega)
    M = M.at[19,51].set(delta * omega)
    M = M.at[20,7].set(eta * omega)
    M = M.at[20,16].set(eta * omega)
    M = M.at[20,17].set(epsilon)
    M = M.at[20,18].set(delta)
    M = M.at[20,19].set(alpha)
    M = M.at[20,24].set(beta * omega)
    M = M.at[20,28].set(delta * omega)
    M = M.at[20,36].set(beta * omega)
    M = M.at[20,52].set(delta * omega)
    M = M.at[21,8].set(eta * omega)
    M = M.at[21,13].set(gamma * omega)
    M = M.at[21,17].set(beta * omega)
    M = M.at[21,22].set(eta)
    M = M.at[21,23].set(gamma * omega)
    M = M.at[21,24].set(epsilon * omega)
    M = M.at[21,25].set(alpha * omega)
    M = M.at[21,37].set(beta * omega)
    M = M.at[21,53].set(delta * omega)
    M = M.at[22,9].set(eta * omega)
    M = M.at[22,14].set(gamma * omega)
    M = M.at[22,18].set(beta * omega)
    M = M.at[22,21].set(eta)
    M = M.at[22,23].set(beta * omega)
    M = M.at[22,24].set(delta * omega)
    M = M.at[22,26].set(alpha * omega)
    M = M.at[22,38].set(beta * omega)
    M = M.at[22,54].set(delta * omega)
    M = M.at[23,15].set(gamma * omega)
    M = M.at[23,19].set(beta * omega)
    M = M.at[23,21].set(gamma * omega)
    M = M.at[23,22].set(beta * omega)
    M = M.at[23,24].set(alpha)
    M = M.at[23,27].set(alpha * omega)
    M = M.at[23,39].set(beta * omega)
    M = M.at[23,55].set(delta * omega)
    M = M.at[24,16].set(gamma * omega)
    M = M.at[24,20].set(beta * omega)
    M = M.at[24,21].set(epsilon * omega)
    M = M.at[24,22].set(delta * omega)
    M = M.at[24,23].set(alpha)
    M = M.at[24,28].set(alpha * omega)
    M = M.at[24,40].set(beta * omega)
    M = M.at[24,56].set(delta * omega)
    M = M.at[25,10].set(eta * omega)
    M = M.at[25,13].set(epsilon * omega)
    M = M.at[25,17].set(delta * omega)
    M = M.at[25,21].set(alpha * omega)
    M = M.at[25,26].set(eta)
    M = M.at[25,27].set(gamma)
    M = M.at[25,28].set(epsilon)
    M = M.at[25,41].set(beta * omega)
    M = M.at[25,57].set(delta * omega)
    M = M.at[26,11].set(eta * omega)
    M = M.at[26,14].set(epsilon * omega)
    M = M.at[26,18].set(delta * omega)
    M = M.at[26,22].set(alpha * omega)
    M = M.at[26,25].set(eta)
    M = M.at[26,27].set(beta)
    M = M.at[26,28].set(delta)
    M = M.at[26,42].set(beta * omega)
    M = M.at[26,58].set(delta * omega)
    M = M.at[27,15].set(epsilon * omega)
    M = M.at[27,19].set(delta * omega)
    M = M.at[27,23].set(alpha * omega)
    M = M.at[27,25].set(gamma)
    M = M.at[27,26].set(beta)
    M = M.at[27,28].set(alpha)
    M = M.at[27,43].set(beta)
    M = M.at[27,59].set(delta * omega)
    M = M.at[28,12].set(eta * omega)
    M = M.at[28,16].set(epsilon * omega)
    M = M.at[28,20].set(delta * omega)
    M = M.at[28,24].set(alpha * omega)
    M = M.at[28,25].set(epsilon)
    M = M.at[28,26].set(delta)
    M = M.at[28,27].set(alpha)
    M = M.at[28,44].set(beta)
    M = M.at[28,60].set(delta * omega)
    M = M.at[29,0].set(gamma * omega)
    M = M.at[29,13].set(beta * omega)
    M = M.at[29,30].set(eta)
    M = M.at[29,31].set(gamma)
    M = M.at[29,32].set(epsilon * omega)
    M = M.at[29,33].set(eta * omega)
    M = M.at[29,37].set(gamma * omega)
    M = M.at[29,41].set(epsilon * omega)
    M = M.at[29,45].set(alpha * omega)
    M = M.at[30,1].set(gamma * omega)
    M = M.at[30,14].set(beta * omega)
    M = M.at[30,29].set(eta)
    M = M.at[30,31].set(beta)
    M = M.at[30,32].set(delta * omega)
    M = M.at[30,34].set(eta * omega)
    M = M.at[30,38].set(gamma * omega)
    M = M.at[30,42].set(epsilon * omega)
    M = M.at[30,46].set(alpha * omega)
    M = M.at[31,2].set(gamma * omega)
    M = M.at[31,15].set(beta * omega)
    M = M.at[31,29].set(gamma)
    M = M.at[31,30].set(beta)
    M = M.at[31,32].set(alpha * omega)
    M = M.at[31,35].set(eta * omega)
    M = M.at[31,39].set(gamma * omega)
    M = M.at[31,43].set(epsilon * omega)
    M = M.at[31,47].set(alpha * omega)
    M = M.at[32,3].set(gamma * omega)
    M = M.at[32,16].set(beta * omega)
    M = M.at[32,29].set(epsilon * omega)
    M = M.at[32,30].set(delta * omega)
    M = M.at[32,31].set(alpha * omega)
    M = M.at[32,36].set(eta * omega)
    M = M.at[32,40].set(gamma * omega)
    M = M.at[32,44].set(epsilon * omega)
    M = M.at[32,48].set(alpha * omega)
    M = M.at[33,4].set(gamma * omega)
    M = M.at[33,17].set(beta * omega)
    M = M.at[33,29].set(eta * omega)
    M = M.at[33,34].set(eta)
    M = M.at[33,35].set(gamma)
    M = M.at[33,36].set(epsilon)
    M = M.at[33,37].set(beta * omega)
    M = M.at[33,41].set(delta * omega)
    M = M.at[33,49].set(alpha * omega)
    M = M.at[34,5].set(gamma * omega)
    M = M.at[34,18].set(beta * omega)
    M = M.at[34,30].set(eta * omega)
    M = M.at[34,33].set(eta)
    M = M.at[34,35].set(beta)
    M = M.at[34,36].set(delta)
    M = M.at[34,38].set(beta * omega)
    M = M.at[34,42].set(delta * omega)
    M = M.at[34,50].set(alpha * omega)
    M = M.at[35,6].set(gamma * omega)
    M = M.at[35,19].set(beta * omega)
    M = M.at[35,31].set(eta * omega)
    M = M.at[35,33].set(gamma)
    M = M.at[35,34].set(beta)
    M = M.at[35,36].set(alpha)
    M = M.at[35,39].set(beta * omega)
    M = M.at[35,43].set(delta * omega)
    M = M.at[35,51].set(alpha * omega)
    M = M.at[36,7].set(gamma * omega)
    M = M.at[36,20].set(beta * omega)
    M = M.at[36,32].set(eta * omega)
    M = M.at[36,33].set(epsilon)
    M = M.at[36,34].set(delta)
    M = M.at[36,35].set(alpha)
    M = M.at[36,40].set(beta * omega)
    M = M.at[36,44].set(delta * omega)
    M = M.at[36,52].set(alpha * omega)
    M = M.at[37,8].set(gamma * omega)
    M = M.at[37,21].set(beta * omega)
    M = M.at[37,29].set(gamma * omega)
    M = M.at[37,33].set(beta * omega)
    M = M.at[37,38].set(eta)
    M = M.at[37,39].set(gamma * omega)
    M = M.at[37,40].set(epsilon * omega)
    M = M.at[37,41].set(alpha * omega)
    M = M.at[37,53].set(alpha * omega)
    M = M.at[38,9].set(gamma * omega)
    M = M.at[38,22].set(beta * omega)
    M = M.at[38,30].set(gamma * omega)
    M = M.at[38,34].set(beta * omega)
    M = M.at[38,37].set(eta)
    M = M.at[38,39].set(beta * omega)
    M = M.at[38,40].set(delta * omega)
    M = M.at[38,42].set(alpha * omega)
    M = M.at[38,54].set(alpha * omega)
    M = M.at[39,23].set(beta * omega)
    M = M.at[39,31].set(gamma * omega)
    M = M.at[39,35].set(beta * omega)
    M = M.at[39,37].set(gamma * omega)
    M = M.at[39,38].set(beta * omega)
    M = M.at[39,40].set(alpha)
    M = M.at[39,43].set(alpha * omega)
    M = M.at[39,55].set(alpha * omega)
    M = M.at[40,24].set(beta * omega)
    M = M.at[40,32].set(gamma * omega)
    M = M.at[40,36].set(beta * omega)
    M = M.at[40,37].set(epsilon * omega)
    M = M.at[40,38].set(delta * omega)
    M = M.at[40,39].set(alpha)
    M = M.at[40,44].set(alpha * omega)
    M = M.at[40,56].set(alpha * omega)
    M = M.at[41,10].set(gamma * omega)
    M = M.at[41,25].set(beta * omega)
    M = M.at[41,29].set(epsilon * omega)
    M = M.at[41,33].set(delta * omega)
    M = M.at[41,37].set(alpha * omega)
    M = M.at[41,42].set(eta)
    M = M.at[41,43].set(gamma * omega)
    M = M.at[41,44].set(epsilon * omega)
    M = M.at[41,57].set(alpha * omega)
    M = M.at[42,11].set(gamma * omega)
    M = M.at[42,26].set(beta * omega)
    M = M.at[42,30].set(epsilon * omega)
    M = M.at[42,34].set(delta * omega)
    M = M.at[42,38].set(alpha * omega)
    M = M.at[42,41].set(eta)
    M = M.at[42,43].set(beta * omega)
    M = M.at[42,44].set(delta * omega)
    M = M.at[42,58].set(alpha * omega)
    M = M.at[43,27].set(beta)
    M = M.at[43,31].set(epsilon * omega)
    M = M.at[43,35].set(delta * omega)
    M = M.at[43,39].set(alpha * omega)
    M = M.at[43,41].set(gamma * omega)
    M = M.at[43,42].set(beta * omega)
    M = M.at[43,44].set(alpha)
    M = M.at[43,59].set(alpha * omega)
    M = M.at[44,12].set(gamma * omega)
    M = M.at[44,28].set(beta)
    M = M.at[44,32].set(epsilon * omega)
    M = M.at[44,36].set(delta * omega)
    M = M.at[44,40].set(alpha * omega)
    M = M.at[44,41].set(epsilon * omega)
    M = M.at[44,42].set(delta * omega)
    M = M.at[44,43].set(alpha)
    M = M.at[44,60].set(alpha * omega)
    M = M.at[45,0].set(epsilon * omega)
    M = M.at[45,13].set(delta * omega)
    M = M.at[45,29].set(alpha * omega)
    M = M.at[45,46].set(eta)
    M = M.at[45,47].set(gamma)
    M = M.at[45,48].set(epsilon)
    M = M.at[45,49].set(eta * omega)
    M = M.at[45,53].set(gamma * omega)
    M = M.at[45,57].set(epsilon * omega)
    M = M.at[46,1].set(epsilon * omega)
    M = M.at[46,14].set(delta * omega)
    M = M.at[46,30].set(alpha * omega)
    M = M.at[46,45].set(eta)
    M = M.at[46,47].set(beta)
    M = M.at[46,48].set(delta)
    M = M.at[46,50].set(eta * omega)
    M = M.at[46,54].set(gamma * omega)
    M = M.at[46,58].set(epsilon * omega)
    M = M.at[47,2].set(epsilon * omega)
    M = M.at[47,15].set(delta * omega)
    M = M.at[47,31].set(alpha * omega)
    M = M.at[47,45].set(gamma)
    M = M.at[47,46].set(beta)
    M = M.at[47,48].set(alpha)
    M = M.at[47,51].set(eta * omega)
    M = M.at[47,55].set(gamma * omega)
    M = M.at[47,59].set(epsilon * omega)
    M = M.at[48,3].set(epsilon * omega)
    M = M.at[48,16].set(delta * omega)
    M = M.at[48,32].set(alpha * omega)
    M = M.at[48,45].set(epsilon)
    M = M.at[48,46].set(delta)
    M = M.at[48,47].set(alpha)
    M = M.at[48,52].set(eta * omega)
    M = M.at[48,56].set(gamma * omega)
    M = M.at[48,60].set(epsilon * omega)
    M = M.at[49,4].set(epsilon * omega)
    M = M.at[49,17].set(delta * omega)
    M = M.at[49,33].set(alpha * omega)
    M = M.at[49,45].set(eta * omega)
    M = M.at[49,50].set(eta)
    M = M.at[49,51].set(gamma)
    M = M.at[49,52].set(epsilon)
    M = M.at[49,53].set(beta * omega)
    M = M.at[49,57].set(delta * omega)
    M = M.at[50,5].set(epsilon * omega)
    M = M.at[50,18].set(delta * omega)
    M = M.at[50,34].set(alpha * omega)
    M = M.at[50,46].set(eta * omega)
    M = M.at[50,49].set(eta)
    M = M.at[50,51].set(beta)
    M = M.at[50,52].set(delta)
    M = M.at[50,54].set(beta * omega)
    M = M.at[50,58].set(delta * omega)
    M = M.at[51,6].set(epsilon * omega)
    M = M.at[51,19].set(delta * omega)
    M = M.at[51,35].set(alpha * omega)
    M = M.at[51,47].set(eta * omega)
    M = M.at[51,49].set(gamma)
    M = M.at[51,50].set(beta)
    M = M.at[51,52].set(alpha)
    M = M.at[51,55].set(beta * omega)
    M = M.at[51,59].set(delta * omega)
    M = M.at[52,7].set(epsilon * omega)
    M = M.at[52,20].set(delta * omega)
    M = M.at[52,36].set(alpha * omega)
    M = M.at[52,48].set(eta * omega)
    M = M.at[52,49].set(epsilon)
    M = M.at[52,50].set(delta)
    M = M.at[52,51].set(alpha)
    M = M.at[52,56].set(beta * omega)
    M = M.at[52,60].set(delta * omega)
    M = M.at[53,8].set(epsilon * omega)
    M = M.at[53,21].set(delta * omega)
    M = M.at[53,37].set(alpha * omega)
    M = M.at[53,45].set(gamma * omega)
    M = M.at[53,49].set(beta * omega)
    M = M.at[53,54].set(eta)
    M = M.at[53,55].set(gamma * omega)
    M = M.at[53,56].set(epsilon * omega)
    M = M.at[53,57].set(alpha * omega)
    M = M.at[54,9].set(epsilon * omega)
    M = M.at[54,22].set(delta * omega)
    M = M.at[54,38].set(alpha * omega)
    M = M.at[54,46].set(gamma * omega)
    M = M.at[54,50].set(beta * omega)
    M = M.at[54,53].set(eta)
    M = M.at[54,55].set(beta * omega)
    M = M.at[54,56].set(delta * omega)
    M = M.at[54,58].set(alpha * omega)
    M = M.at[55,23].set(delta * omega)
    M = M.at[55,39].set(alpha * omega)
    M = M.at[55,47].set(gamma * omega)
    M = M.at[55,51].set(beta * omega)
    M = M.at[55,53].set(gamma * omega)
    M = M.at[55,54].set(beta * omega)
    M = M.at[55,56].set(alpha)
    M = M.at[55,59].set(alpha * omega)
    M = M.at[56,24].set(delta * omega)
    M = M.at[56,40].set(alpha * omega)
    M = M.at[56,48].set(gamma * omega)
    M = M.at[56,52].set(beta * omega)
    M = M.at[56,53].set(epsilon * omega)
    M = M.at[56,54].set(delta * omega)
    M = M.at[56,55].set(alpha)
    M = M.at[56,60].set(alpha * omega)
    M = M.at[57,10].set(epsilon * omega)
    M = M.at[57,25].set(delta * omega)
    M = M.at[57,41].set(alpha * omega)
    M = M.at[57,45].set(epsilon * omega)
    M = M.at[57,49].set(delta * omega)
    M = M.at[57,53].set(alpha * omega)
    M = M.at[57,58].set(eta)
    M = M.at[57,59].set(gamma)
    M = M.at[57,60].set(epsilon)
    M = M.at[58,11].set(epsilon * omega)
    M = M.at[58,26].set(delta * omega)
    M = M.at[58,42].set(alpha * omega)
    M = M.at[58,46].set(epsilon * omega)
    M = M.at[58,50].set(delta * omega)
    M = M.at[58,54].set(alpha * omega)
    M = M.at[58,57].set(eta)
    M = M.at[58,59].set(beta)
    M = M.at[58,60].set(delta)
    M = M.at[59,27].set(delta * omega)
    M = M.at[59,43].set(alpha * omega)
    M = M.at[59,47].set(epsilon * omega)
    M = M.at[59,51].set(delta * omega)
    M = M.at[59,55].set(alpha * omega)
    M = M.at[59,57].set(gamma)
    M = M.at[59,58].set(beta)
    M = M.at[59,60].set(alpha)
    M = M.at[60,12].set(epsilon * omega)
    M = M.at[60,28].set(delta * omega)
    M = M.at[60,44].set(alpha * omega)
    M = M.at[60,48].set(epsilon * omega)
    M = M.at[60,52].set(delta * omega)
    M = M.at[60,56].set(alpha * omega)
    M = M.at[60,57].set(epsilon)
    M = M.at[60,58].set(delta)
    M = M.at[60,59].set(alpha)

    M = jnp.matmul(jnp.matmul(M, pimat).T, pimat).T
    M = diag_update(M, pimult)

    return M

@jit
def update_GTR(M, omega, pimult):
    # wasteful but 'neat'?
    # M = jnp.multiply(M, jnp.multiply(omega_mat, omega) + non_omega_mat)

    Mout = M.copy()
    Mout = Mout.at[0,2].set(Mout.get[0,2] * omega)
    Mout = Mout.at[0,3].set(Mout.get[0,3] * omega)
    Mout = Mout.at[0,4].set(Mout.get[0,4] * omega)
    Mout = Mout.at[0,8].set(Mout.get[0,8] * omega)
    Mout = Mout.at[0,10].set(Mout.get[0,10] * omega)
    Mout = Mout.at[0,13].set(Mout.get[0,13] * omega)
    Mout = Mout.at[0,29].set(Mout.get[0,29] * omega)
    Mout = Mout.at[0,45].set(Mout.get[0,45] * omega)
    Mout = Mout.at[1,2].set(Mout.get[1,2] * omega)
    Mout = Mout.at[1,3].set(Mout.get[1,3] * omega)
    Mout = Mout.at[1,5].set(Mout.get[1,5] * omega)
    Mout = Mout.at[1,9].set(Mout.get[1,9] * omega)
    Mout = Mout.at[1,11].set(Mout.get[1,11] * omega)
    Mout = Mout.at[1,14].set(Mout.get[1,14] * omega)
    Mout = Mout.at[1,30].set(Mout.get[1,30] * omega)
    Mout = Mout.at[1,46].set(Mout.get[1,46] * omega)
    Mout = Mout.at[2,0].set(Mout.get[2,0] * omega)
    Mout = Mout.at[2,1].set(Mout.get[2,1] * omega)
    Mout = Mout.at[2,6].set(Mout.get[2,6] * omega)
    Mout = Mout.at[2,31].set(Mout.get[2,31] * omega)
    Mout = Mout.at[2,47].set(Mout.get[2,47] * omega)
    Mout = Mout.at[3,0].set(Mout.get[3,0] * omega)
    Mout = Mout.at[3,1].set(Mout.get[3,1] * omega)
    Mout = Mout.at[3,7].set(Mout.get[3,7] * omega)
    Mout = Mout.at[3,12].set(Mout.get[3,12] * omega)
    Mout = Mout.at[3,32].set(Mout.get[3,32] * omega)
    Mout = Mout.at[3,48].set(Mout.get[3,48] * omega)
    Mout = Mout.at[4,0].set(Mout.get[4,0] * omega)
    Mout = Mout.at[4,8].set(Mout.get[4,8] * omega)
    Mout = Mout.at[4,10].set(Mout.get[4,10] * omega)
    Mout = Mout.at[4,17].set(Mout.get[4,17] * omega)
    Mout = Mout.at[4,33].set(Mout.get[4,33] * omega)
    Mout = Mout.at[4,49].set(Mout.get[4,49] * omega)
    Mout = Mout.at[5,1].set(Mout.get[5,1] * omega)
    Mout = Mout.at[5,9].set(Mout.get[5,9] * omega)
    Mout = Mout.at[5,11].set(Mout.get[5,11] * omega)
    Mout = Mout.at[5,18].set(Mout.get[5,18] * omega)
    Mout = Mout.at[5,34].set(Mout.get[5,34] * omega)
    Mout = Mout.at[5,50].set(Mout.get[5,50] * omega)
    Mout = Mout.at[6,2].set(Mout.get[6,2] * omega)
    Mout = Mout.at[6,19].set(Mout.get[6,19] * omega)
    Mout = Mout.at[6,35].set(Mout.get[6,35] * omega)
    Mout = Mout.at[6,51].set(Mout.get[6,51] * omega)
    Mout = Mout.at[7,3].set(Mout.get[7,3] * omega)
    Mout = Mout.at[7,12].set(Mout.get[7,12] * omega)
    Mout = Mout.at[7,20].set(Mout.get[7,20] * omega)
    Mout = Mout.at[7,36].set(Mout.get[7,36] * omega)
    Mout = Mout.at[7,52].set(Mout.get[7,52] * omega)
    Mout = Mout.at[8,0].set(Mout.get[8,0] * omega)
    Mout = Mout.at[8,4].set(Mout.get[8,4] * omega)
    Mout = Mout.at[8,10].set(Mout.get[8,10] * omega)
    Mout = Mout.at[8,21].set(Mout.get[8,21] * omega)
    Mout = Mout.at[8,37].set(Mout.get[8,37] * omega)
    Mout = Mout.at[8,53].set(Mout.get[8,53] * omega)
    Mout = Mout.at[9,1].set(Mout.get[9,1] * omega)
    Mout = Mout.at[9,5].set(Mout.get[9,5] * omega)
    Mout = Mout.at[9,11].set(Mout.get[9,11] * omega)
    Mout = Mout.at[9,22].set(Mout.get[9,22] * omega)
    Mout = Mout.at[9,38].set(Mout.get[9,38] * omega)
    Mout = Mout.at[9,54].set(Mout.get[9,54] * omega)
    Mout = Mout.at[10,0].set(Mout.get[10,0] * omega)
    Mout = Mout.at[10,4].set(Mout.get[10,4] * omega)
    Mout = Mout.at[10,8].set(Mout.get[10,8] * omega)
    Mout = Mout.at[10,12].set(Mout.get[10,12] * omega)
    Mout = Mout.at[10,25].set(Mout.get[10,25] * omega)
    Mout = Mout.at[10,41].set(Mout.get[10,41] * omega)
    Mout = Mout.at[10,57].set(Mout.get[10,57] * omega)
    Mout = Mout.at[11,1].set(Mout.get[11,1] * omega)
    Mout = Mout.at[11,5].set(Mout.get[11,5] * omega)
    Mout = Mout.at[11,9].set(Mout.get[11,9] * omega)
    Mout = Mout.at[11,12].set(Mout.get[11,12] * omega)
    Mout = Mout.at[11,26].set(Mout.get[11,26] * omega)
    Mout = Mout.at[11,42].set(Mout.get[11,42] * omega)
    Mout = Mout.at[11,58].set(Mout.get[11,58] * omega)
    Mout = Mout.at[12,3].set(Mout.get[12,3] * omega)
    Mout = Mout.at[12,7].set(Mout.get[12,7] * omega)
    Mout = Mout.at[12,10].set(Mout.get[12,10] * omega)
    Mout = Mout.at[12,11].set(Mout.get[12,11] * omega)
    Mout = Mout.at[12,28].set(Mout.get[12,28] * omega)
    Mout = Mout.at[12,44].set(Mout.get[12,44] * omega)
    Mout = Mout.at[12,60].set(Mout.get[12,60] * omega)
    Mout = Mout.at[13,0].set(Mout.get[13,0] * omega)
    Mout = Mout.at[13,17].set(Mout.get[13,17] * omega)
    Mout = Mout.at[13,21].set(Mout.get[13,21] * omega)
    Mout = Mout.at[13,25].set(Mout.get[13,25] * omega)
    Mout = Mout.at[13,29].set(Mout.get[13,29] * omega)
    Mout = Mout.at[13,45].set(Mout.get[13,45] * omega)
    Mout = Mout.at[14,1].set(Mout.get[14,1] * omega)
    Mout = Mout.at[14,18].set(Mout.get[14,18] * omega)
    Mout = Mout.at[14,22].set(Mout.get[14,22] * omega)
    Mout = Mout.at[14,26].set(Mout.get[14,26] * omega)
    Mout = Mout.at[14,30].set(Mout.get[14,30] * omega)
    Mout = Mout.at[14,46].set(Mout.get[14,46] * omega)
    Mout = Mout.at[15,19].set(Mout.get[15,19] * omega)
    Mout = Mout.at[15,23].set(Mout.get[15,23] * omega)
    Mout = Mout.at[15,27].set(Mout.get[15,27] * omega)
    Mout = Mout.at[15,31].set(Mout.get[15,31] * omega)
    Mout = Mout.at[15,47].set(Mout.get[15,47] * omega)
    Mout = Mout.at[16,20].set(Mout.get[16,20] * omega)
    Mout = Mout.at[16,24].set(Mout.get[16,24] * omega)
    Mout = Mout.at[16,28].set(Mout.get[16,28] * omega)
    Mout = Mout.at[16,32].set(Mout.get[16,32] * omega)
    Mout = Mout.at[16,48].set(Mout.get[16,48] * omega)
    Mout = Mout.at[17,4].set(Mout.get[17,4] * omega)
    Mout = Mout.at[17,13].set(Mout.get[17,13] * omega)
    Mout = Mout.at[17,21].set(Mout.get[17,21] * omega)
    Mout = Mout.at[17,25].set(Mout.get[17,25] * omega)
    Mout = Mout.at[17,33].set(Mout.get[17,33] * omega)
    Mout = Mout.at[17,49].set(Mout.get[17,49] * omega)
    Mout = Mout.at[18,5].set(Mout.get[18,5] * omega)
    Mout = Mout.at[18,14].set(Mout.get[18,14] * omega)
    Mout = Mout.at[18,22].set(Mout.get[18,22] * omega)
    Mout = Mout.at[18,26].set(Mout.get[18,26] * omega)
    Mout = Mout.at[18,34].set(Mout.get[18,34] * omega)
    Mout = Mout.at[18,50].set(Mout.get[18,50] * omega)
    Mout = Mout.at[19,6].set(Mout.get[19,6] * omega)
    Mout = Mout.at[19,15].set(Mout.get[19,15] * omega)
    Mout = Mout.at[19,23].set(Mout.get[19,23] * omega)
    Mout = Mout.at[19,27].set(Mout.get[19,27] * omega)
    Mout = Mout.at[19,35].set(Mout.get[19,35] * omega)
    Mout = Mout.at[19,51].set(Mout.get[19,51] * omega)
    Mout = Mout.at[20,7].set(Mout.get[20,7] * omega)
    Mout = Mout.at[20,16].set(Mout.get[20,16] * omega)
    Mout = Mout.at[20,24].set(Mout.get[20,24] * omega)
    Mout = Mout.at[20,28].set(Mout.get[20,28] * omega)
    Mout = Mout.at[20,36].set(Mout.get[20,36] * omega)
    Mout = Mout.at[20,52].set(Mout.get[20,52] * omega)
    Mout = Mout.at[21,8].set(Mout.get[21,8] * omega)
    Mout = Mout.at[21,13].set(Mout.get[21,13] * omega)
    Mout = Mout.at[21,17].set(Mout.get[21,17] * omega)
    Mout = Mout.at[21,23].set(Mout.get[21,23] * omega)
    Mout = Mout.at[21,24].set(Mout.get[21,24] * omega)
    Mout = Mout.at[21,25].set(Mout.get[21,25] * omega)
    Mout = Mout.at[21,37].set(Mout.get[21,37] * omega)
    Mout = Mout.at[21,53].set(Mout.get[21,53] * omega)
    Mout = Mout.at[22,9].set(Mout.get[22,9] * omega)
    Mout = Mout.at[22,14].set(Mout.get[22,14] * omega)
    Mout = Mout.at[22,18].set(Mout.get[22,18] * omega)
    Mout = Mout.at[22,23].set(Mout.get[22,23] * omega)
    Mout = Mout.at[22,24].set(Mout.get[22,24] * omega)
    Mout = Mout.at[22,26].set(Mout.get[22,26] * omega)
    Mout = Mout.at[22,38].set(Mout.get[22,38] * omega)
    Mout = Mout.at[22,54].set(Mout.get[22,54] * omega)
    Mout = Mout.at[23,15].set(Mout.get[23,15] * omega)
    Mout = Mout.at[23,19].set(Mout.get[23,19] * omega)
    Mout = Mout.at[23,21].set(Mout.get[23,21] * omega)
    Mout = Mout.at[23,22].set(Mout.get[23,22] * omega)
    Mout = Mout.at[23,27].set(Mout.get[23,27] * omega)
    Mout = Mout.at[23,39].set(Mout.get[23,39] * omega)
    Mout = Mout.at[23,55].set(Mout.get[23,55] * omega)
    Mout = Mout.at[24,16].set(Mout.get[24,16] * omega)
    Mout = Mout.at[24,20].set(Mout.get[24,20] * omega)
    Mout = Mout.at[24,21].set(Mout.get[24,21] * omega)
    Mout = Mout.at[24,22].set(Mout.get[24,22] * omega)
    Mout = Mout.at[24,28].set(Mout.get[24,28] * omega)
    Mout = Mout.at[24,40].set(Mout.get[24,40] * omega)
    Mout = Mout.at[24,56].set(Mout.get[24,56] * omega)
    Mout = Mout.at[25,10].set(Mout.get[25,10] * omega)
    Mout = Mout.at[25,13].set(Mout.get[25,13] * omega)
    Mout = Mout.at[25,17].set(Mout.get[25,17] * omega)
    Mout = Mout.at[25,21].set(Mout.get[25,21] * omega)
    Mout = Mout.at[25,41].set(Mout.get[25,41] * omega)
    Mout = Mout.at[25,57].set(Mout.get[25,57] * omega)
    Mout = Mout.at[26,11].set(Mout.get[26,11] * omega)
    Mout = Mout.at[26,14].set(Mout.get[26,14] * omega)
    Mout = Mout.at[26,18].set(Mout.get[26,18] * omega)
    Mout = Mout.at[26,22].set(Mout.get[26,22] * omega)
    Mout = Mout.at[26,42].set(Mout.get[26,42] * omega)
    Mout = Mout.at[26,58].set(Mout.get[26,58] * omega)
    Mout = Mout.at[27,15].set(Mout.get[27,15] * omega)
    Mout = Mout.at[27,19].set(Mout.get[27,19] * omega)
    Mout = Mout.at[27,23].set(Mout.get[27,23] * omega)
    Mout = Mout.at[27,59].set(Mout.get[27,59] * omega)
    Mout = Mout.at[28,12].set(Mout.get[28,12] * omega)
    Mout = Mout.at[28,16].set(Mout.get[28,16] * omega)
    Mout = Mout.at[28,20].set(Mout.get[28,20] * omega)
    Mout = Mout.at[28,24].set(Mout.get[28,24] * omega)
    Mout = Mout.at[28,60].set(Mout.get[28,60] * omega)
    Mout = Mout.at[29,0].set(Mout.get[29,0] * omega)
    Mout = Mout.at[29,13].set(Mout.get[29,13] * omega)
    Mout = Mout.at[29,32].set(Mout.get[29,32] * omega)
    Mout = Mout.at[29,33].set(Mout.get[29,33] * omega)
    Mout = Mout.at[29,37].set(Mout.get[29,37] * omega)
    Mout = Mout.at[29,41].set(Mout.get[29,41] * omega)
    Mout = Mout.at[29,45].set(Mout.get[29,45] * omega)
    Mout = Mout.at[30,1].set(Mout.get[30,1] * omega)
    Mout = Mout.at[30,14].set(Mout.get[30,14] * omega)
    Mout = Mout.at[30,32].set(Mout.get[30,32] * omega)
    Mout = Mout.at[30,34].set(Mout.get[30,34] * omega)
    Mout = Mout.at[30,38].set(Mout.get[30,38] * omega)
    Mout = Mout.at[30,42].set(Mout.get[30,42] * omega)
    Mout = Mout.at[30,46].set(Mout.get[30,46] * omega)
    Mout = Mout.at[31,2].set(Mout.get[31,2] * omega)
    Mout = Mout.at[31,15].set(Mout.get[31,15] * omega)
    Mout = Mout.at[31,32].set(Mout.get[31,32] * omega)
    Mout = Mout.at[31,35].set(Mout.get[31,35] * omega)
    Mout = Mout.at[31,39].set(Mout.get[31,39] * omega)
    Mout = Mout.at[31,43].set(Mout.get[31,43] * omega)
    Mout = Mout.at[31,47].set(Mout.get[31,47] * omega)
    Mout = Mout.at[32,3].set(Mout.get[32,3] * omega)
    Mout = Mout.at[32,16].set(Mout.get[32,16] * omega)
    Mout = Mout.at[32,29].set(Mout.get[32,29] * omega)
    Mout = Mout.at[32,30].set(Mout.get[32,30] * omega)
    Mout = Mout.at[32,31].set(Mout.get[32,31] * omega)
    Mout = Mout.at[32,36].set(Mout.get[32,36] * omega)
    Mout = Mout.at[32,40].set(Mout.get[32,40] * omega)
    Mout = Mout.at[32,44].set(Mout.get[32,44] * omega)
    Mout = Mout.at[32,48].set(Mout.get[32,48] * omega)
    Mout = Mout.at[33,4].set(Mout.get[33,4] * omega)
    Mout = Mout.at[33,17].set(Mout.get[33,17] * omega)
    Mout = Mout.at[33,29].set(Mout.get[33,29] * omega)
    Mout = Mout.at[33,37].set(Mout.get[33,37] * omega)
    Mout = Mout.at[33,41].set(Mout.get[33,41] * omega)
    Mout = Mout.at[33,49].set(Mout.get[33,49] * omega)
    Mout = Mout.at[34,5].set(Mout.get[34,5] * omega)
    Mout = Mout.at[34,18].set(Mout.get[34,18] * omega)
    Mout = Mout.at[34,30].set(Mout.get[34,30] * omega)
    Mout = Mout.at[34,38].set(Mout.get[34,38] * omega)
    Mout = Mout.at[34,42].set(Mout.get[34,42] * omega)
    Mout = Mout.at[34,50].set(Mout.get[34,50] * omega)
    Mout = Mout.at[35,6].set(Mout.get[35,6] * omega)
    Mout = Mout.at[35,19].set(Mout.get[35,19] * omega)
    Mout = Mout.at[35,31].set(Mout.get[35,31] * omega)
    Mout = Mout.at[35,39].set(Mout.get[35,39] * omega)
    Mout = Mout.at[35,43].set(Mout.get[35,43] * omega)
    Mout = Mout.at[35,51].set(Mout.get[35,51] * omega)
    Mout = Mout.at[36,7].set(Mout.get[36,7] * omega)
    Mout = Mout.at[36,20].set(Mout.get[36,20] * omega)
    Mout = Mout.at[36,32].set(Mout.get[36,32] * omega)
    Mout = Mout.at[36,40].set(Mout.get[36,40] * omega)
    Mout = Mout.at[36,44].set(Mout.get[36,44] * omega)
    Mout = Mout.at[36,52].set(Mout.get[36,52] * omega)
    Mout = Mout.at[37,8].set(Mout.get[37,8] * omega)
    Mout = Mout.at[37,21].set(Mout.get[37,21] * omega)
    Mout = Mout.at[37,29].set(Mout.get[37,29] * omega)
    Mout = Mout.at[37,33].set(Mout.get[37,33] * omega)
    Mout = Mout.at[37,39].set(Mout.get[37,39] * omega)
    Mout = Mout.at[37,40].set(Mout.get[37,40] * omega)
    Mout = Mout.at[37,41].set(Mout.get[37,41] * omega)
    Mout = Mout.at[37,53].set(Mout.get[37,53] * omega)
    Mout = Mout.at[38,9].set(Mout.get[38,9] * omega)
    Mout = Mout.at[38,22].set(Mout.get[38,22] * omega)
    Mout = Mout.at[38,30].set(Mout.get[38,30] * omega)
    Mout = Mout.at[38,34].set(Mout.get[38,34] * omega)
    Mout = Mout.at[38,39].set(Mout.get[38,39] * omega)
    Mout = Mout.at[38,40].set(Mout.get[38,40] * omega)
    Mout = Mout.at[38,42].set(Mout.get[38,42] * omega)
    Mout = Mout.at[38,54].set(Mout.get[38,54] * omega)
    Mout = Mout.at[39,23].set(Mout.get[39,23] * omega)
    Mout = Mout.at[39,31].set(Mout.get[39,31] * omega)
    Mout = Mout.at[39,35].set(Mout.get[39,35] * omega)
    Mout = Mout.at[39,37].set(Mout.get[39,37] * omega)
    Mout = Mout.at[39,38].set(Mout.get[39,38] * omega)
    Mout = Mout.at[39,43].set(Mout.get[39,43] * omega)
    Mout = Mout.at[39,55].set(Mout.get[39,55] * omega)
    Mout = Mout.at[40,24].set(Mout.get[40,24] * omega)
    Mout = Mout.at[40,32].set(Mout.get[40,32] * omega)
    Mout = Mout.at[40,36].set(Mout.get[40,36] * omega)
    Mout = Mout.at[40,37].set(Mout.get[40,37] * omega)
    Mout = Mout.at[40,38].set(Mout.get[40,38] * omega)
    Mout = Mout.at[40,44].set(Mout.get[40,44] * omega)
    Mout = Mout.at[40,56].set(Mout.get[40,56] * omega)
    Mout = Mout.at[41,10].set(Mout.get[41,10] * omega)
    Mout = Mout.at[41,25].set(Mout.get[41,25] * omega)
    Mout = Mout.at[41,29].set(Mout.get[41,29] * omega)
    Mout = Mout.at[41,33].set(Mout.get[41,33] * omega)
    Mout = Mout.at[41,37].set(Mout.get[41,37] * omega)
    Mout = Mout.at[41,43].set(Mout.get[41,43] * omega)
    Mout = Mout.at[41,44].set(Mout.get[41,44] * omega)
    Mout = Mout.at[41,57].set(Mout.get[41,57] * omega)
    Mout = Mout.at[42,11].set(Mout.get[42,11] * omega)
    Mout = Mout.at[42,26].set(Mout.get[42,26] * omega)
    Mout = Mout.at[42,30].set(Mout.get[42,30] * omega)
    Mout = Mout.at[42,34].set(Mout.get[42,34] * omega)
    Mout = Mout.at[42,38].set(Mout.get[42,38] * omega)
    Mout = Mout.at[42,43].set(Mout.get[42,43] * omega)
    Mout = Mout.at[42,44].set(Mout.get[42,44] * omega)
    Mout = Mout.at[42,58].set(Mout.get[42,58] * omega)
    Mout = Mout.at[43,31].set(Mout.get[43,31] * omega)
    Mout = Mout.at[43,35].set(Mout.get[43,35] * omega)
    Mout = Mout.at[43,39].set(Mout.get[43,39] * omega)
    Mout = Mout.at[43,41].set(Mout.get[43,41] * omega)
    Mout = Mout.at[43,42].set(Mout.get[43,42] * omega)
    Mout = Mout.at[43,59].set(Mout.get[43,59] * omega)
    Mout = Mout.at[44,12].set(Mout.get[44,12] * omega)
    Mout = Mout.at[44,32].set(Mout.get[44,32] * omega)
    Mout = Mout.at[44,36].set(Mout.get[44,36] * omega)
    Mout = Mout.at[44,40].set(Mout.get[44,40] * omega)
    Mout = Mout.at[44,41].set(Mout.get[44,41] * omega)
    Mout = Mout.at[44,42].set(Mout.get[44,42] * omega)
    Mout = Mout.at[44,60].set(Mout.get[44,60] * omega)
    Mout = Mout.at[45,0].set(Mout.get[45,0] * omega)
    Mout = Mout.at[45,13].set(Mout.get[45,13] * omega)
    Mout = Mout.at[45,29].set(Mout.get[45,29] * omega)
    Mout = Mout.at[45,49].set(Mout.get[45,49] * omega)
    Mout = Mout.at[45,53].set(Mout.get[45,53] * omega)
    Mout = Mout.at[45,57].set(Mout.get[45,57] * omega)
    Mout = Mout.at[46,1].set(Mout.get[46,1] * omega)
    Mout = Mout.at[46,14].set(Mout.get[46,14] * omega)
    Mout = Mout.at[46,30].set(Mout.get[46,30] * omega)
    Mout = Mout.at[46,50].set(Mout.get[46,50] * omega)
    Mout = Mout.at[46,54].set(Mout.get[46,54] * omega)
    Mout = Mout.at[46,58].set(Mout.get[46,58] * omega)
    Mout = Mout.at[47,2].set(Mout.get[47,2] * omega)
    Mout = Mout.at[47,15].set(Mout.get[47,15] * omega)
    Mout = Mout.at[47,31].set(Mout.get[47,31] * omega)
    Mout = Mout.at[47,51].set(Mout.get[47,51] * omega)
    Mout = Mout.at[47,55].set(Mout.get[47,55] * omega)
    Mout = Mout.at[47,59].set(Mout.get[47,59] * omega)
    Mout = Mout.at[48,3].set(Mout.get[48,3] * omega)
    Mout = Mout.at[48,16].set(Mout.get[48,16] * omega)
    Mout = Mout.at[48,32].set(Mout.get[48,32] * omega)
    Mout = Mout.at[48,52].set(Mout.get[48,52] * omega)
    Mout = Mout.at[48,56].set(Mout.get[48,56] * omega)
    Mout = Mout.at[48,60].set(Mout.get[48,60] * omega)
    Mout = Mout.at[49,4].set(Mout.get[49,4] * omega)
    Mout = Mout.at[49,17].set(Mout.get[49,17] * omega)
    Mout = Mout.at[49,33].set(Mout.get[49,33] * omega)
    Mout = Mout.at[49,45].set(Mout.get[49,45] * omega)
    Mout = Mout.at[49,53].set(Mout.get[49,53] * omega)
    Mout = Mout.at[49,57].set(Mout.get[49,57] * omega)
    Mout = Mout.at[50,5].set(Mout.get[50,5] * omega)
    Mout = Mout.at[50,18].set(Mout.get[50,18] * omega)
    Mout = Mout.at[50,34].set(Mout.get[50,34] * omega)
    Mout = Mout.at[50,46].set(Mout.get[50,46] * omega)
    Mout = Mout.at[50,54].set(Mout.get[50,54] * omega)
    Mout = Mout.at[50,58].set(Mout.get[50,58] * omega)
    Mout = Mout.at[51,6].set(Mout.get[51,6] * omega)
    Mout = Mout.at[51,19].set(Mout.get[51,19] * omega)
    Mout = Mout.at[51,35].set(Mout.get[51,35] * omega)
    Mout = Mout.at[51,47].set(Mout.get[51,47] * omega)
    Mout = Mout.at[51,55].set(Mout.get[51,55] * omega)
    Mout = Mout.at[51,59].set(Mout.get[51,59] * omega)
    Mout = Mout.at[52,7].set(Mout.get[52,7] * omega)
    Mout = Mout.at[52,20].set(Mout.get[52,20] * omega)
    Mout = Mout.at[52,36].set(Mout.get[52,36] * omega)
    Mout = Mout.at[52,48].set(Mout.get[52,48] * omega)
    Mout = Mout.at[52,56].set(Mout.get[52,56] * omega)
    Mout = Mout.at[52,60].set(Mout.get[52,60] * omega)
    Mout = Mout.at[53,8].set(Mout.get[53,8] * omega)
    Mout = Mout.at[53,21].set(Mout.get[53,21] * omega)
    Mout = Mout.at[53,37].set(Mout.get[53,37] * omega)
    Mout = Mout.at[53,45].set(Mout.get[53,45] * omega)
    Mout = Mout.at[53,49].set(Mout.get[53,49] * omega)
    Mout = Mout.at[53,55].set(Mout.get[53,55] * omega)
    Mout = Mout.at[53,56].set(Mout.get[53,56] * omega)
    Mout = Mout.at[53,57].set(Mout.get[53,57] * omega)
    Mout = Mout.at[54,9].set(Mout.get[54,9] * omega)
    Mout = Mout.at[54,22].set(Mout.get[54,22] * omega)
    Mout = Mout.at[54,38].set(Mout.get[54,38] * omega)
    Mout = Mout.at[54,46].set(Mout.get[54,46] * omega)
    Mout = Mout.at[54,50].set(Mout.get[54,50] * omega)
    Mout = Mout.at[54,55].set(Mout.get[54,55] * omega)
    Mout = Mout.at[54,56].set(Mout.get[54,56] * omega)
    Mout = Mout.at[54,58].set(Mout.get[54,58] * omega)
    Mout = Mout.at[55,23].set(Mout.get[55,23] * omega)
    Mout = Mout.at[55,39].set(Mout.get[55,39] * omega)
    Mout = Mout.at[55,47].set(Mout.get[55,47] * omega)
    Mout = Mout.at[55,51].set(Mout.get[55,51] * omega)
    Mout = Mout.at[55,53].set(Mout.get[55,53] * omega)
    Mout = Mout.at[55,54].set(Mout.get[55,54] * omega)
    Mout = Mout.at[55,59].set(Mout.get[55,59] * omega)
    Mout = Mout.at[56,24].set(Mout.get[56,24] * omega)
    Mout = Mout.at[56,40].set(Mout.get[56,40] * omega)
    Mout = Mout.at[56,48].set(Mout.get[56,48] * omega)
    Mout = Mout.at[56,52].set(Mout.get[56,52] * omega)
    Mout = Mout.at[56,53].set(Mout.get[56,53] * omega)
    Mout = Mout.at[56,54].set(Mout.get[56,54] * omega)
    Mout = Mout.at[56,60].set(Mout.get[56,60] * omega)
    Mout = Mout.at[57,10].set(Mout.get[57,10] * omega)
    Mout = Mout.at[57,25].set(Mout.get[57,25] * omega)
    Mout = Mout.at[57,41].set(Mout.get[57,41] * omega)
    Mout = Mout.at[57,45].set(Mout.get[57,45] * omega)
    Mout = Mout.at[57,49].set(Mout.get[57,49] * omega)
    Mout = Mout.at[57,53].set(Mout.get[57,53] * omega)
    Mout = Mout.at[58,11].set(Mout.get[58,11] * omega)
    Mout = Mout.at[58,26].set(Mout.get[58,26] * omega)
    Mout = Mout.at[58,42].set(Mout.get[58,42] * omega)
    Mout = Mout.at[58,46].set(Mout.get[58,46] * omega)
    Mout = Mout.at[58,50].set(Mout.get[58,50] * omega)
    Mout = Mout.at[58,54].set(Mout.get[58,54] * omega)
    Mout = Mout.at[59,27].set(Mout.get[59,27] * omega)
    Mout = Mout.at[59,43].set(Mout.get[59,43] * omega)
    Mout = Mout.at[59,47].set(Mout.get[59,47] * omega)
    Mout = Mout.at[59,51].set(Mout.get[59,51] * omega)
    Mout = Mout.at[59,55].set(Mout.get[59,55] * omega)
    Mout = Mout.at[60,12].set(Mout.get[60,12] * omega)
    Mout = Mout.at[60,28].set(Mout.get[60,28] * omega)
    Mout = Mout.at[60,44].set(Mout.get[60,44] * omega)
    Mout = Mout.at[60,48].set(Mout.get[60,48] * omega)
    Mout = Mout.at[60,52].set(Mout.get[60,52] * omega)
    Mout = Mout.at[60,56].set(Mout.get[60,56] * omega)

    Mout = diag_update(Mout, pimult)

    return Mout
