import numpy as np
from jax import jit
import jax.numpy as jnp

# Not used for now, see commented code in update_GTR
omega_mat = jnp.array([[0., 0., 1., 1., 1., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 1., 0., 1., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 1., 1.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
        1., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0.,
        0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
        0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 1.,
        0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.]])

non_omega_mat = jnp.array(([[ 1.,  1., 0., 0., 0.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0., 0.,  1., 0.,  1.,  1.,  1., 0.,  1., 0.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0., 0.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1., 0., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1., 0., 0., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1., 0., 0.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1., 0., 0.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
        0., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
        0., 0.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1., 0., 0.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0., 0., 0.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0., 0., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.],
       [0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1., 0., 0., 0.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1., 0., 0.,  1., 0.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1., 0., 0.,  1.,  1.,  1.,  1., 0.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0., 0., 0.,  1.,  1.,  1.,  1.,  1., 0.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
        0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,
         1.,  1.,  1., 0.,  1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1., 0.,
         1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1., 0.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
         1.,  1.,  1.,  1.,  1., 0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,
        0.,  1.,  1.,  1., 0.,  1.,  1.,  1.,  1.]]))

@jit
def diag_update(M, pimult):
    # Compute the diagonal
    index = jnp.arange(0, 61, 1, jnp.uint16)
    # I think this might be the same as
    # M += jnp.diag(jnp.einsum('ij,ij->i', M, pi_mult))
    # but check this doesn't add loads of zeros
    # check https://jax.readthedocs.io/en/latest/_autosummary/jax.lax.fori_loop.html
    for i in range(61):
        # M = M.at[i, i].set(-jnp.dot(M[i, :], pimult[i, :]))
        M = M.at[i, i].set(-jnp.dot(jnp.take(M, index), jnp.take(pimult, index)))
        index += 61 # or use lax.slice?
    return M

@jit
def build_GTR(alpha, beta, gamma, delta, epsilon, eta, omega, pimat, pimult):
    M = jnp.zeros((61, 61))

    M = M.at[0,1].set(eta)
    M = M.at[0,2].set(gamma * omega)
    M = M.at[0,3].set(epsilon * omega)
    M = M.at[0,4].set(eta * omega)
    M = M.at[0,8].set(gamma * omega)
    M = M.at[0,10].set(epsilon * omega)
    M = M.at[0,13].set(eta * omega)
    M = M.at[0,29].set(gamma * omega)
    M = M.at[0,45].set(epsilon * omega)
    M = M.at[1,0].set(eta)
    M = M.at[1,2].set(beta * omega)
    M = M.at[1,3].set(delta * omega)
    M = M.at[1,5].set(eta * omega)
    M = M.at[1,9].set(gamma * omega)
    M = M.at[1,11].set(epsilon * omega)
    M = M.at[1,14].set(eta * omega)
    M = M.at[1,30].set(gamma * omega)
    M = M.at[1,46].set(epsilon * omega)
    M = M.at[2,0].set(gamma * omega)
    M = M.at[2,1].set(beta * omega)
    M = M.at[2,3].set(alpha)
    M = M.at[2,6].set(eta * omega)
    M = M.at[2,15].set(eta)
    M = M.at[2,31].set(gamma * omega)
    M = M.at[2,47].set(epsilon * omega)
    M = M.at[3,0].set(epsilon * omega)
    M = M.at[3,1].set(delta * omega)
    M = M.at[3,2].set(alpha)
    M = M.at[3,7].set(eta * omega)
    M = M.at[3,12].set(epsilon * omega)
    M = M.at[3,16].set(eta)
    M = M.at[3,32].set(gamma * omega)
    M = M.at[3,48].set(epsilon * omega)
    M = M.at[4,0].set(eta * omega)
    M = M.at[4,5].set(eta)
    M = M.at[4,6].set(gamma)
    M = M.at[4,7].set(epsilon)
    M = M.at[4,8].set(beta * omega)
    M = M.at[4,10].set(delta * omega)
    M = M.at[4,17].set(eta * omega)
    M = M.at[4,33].set(gamma * omega)
    M = M.at[4,49].set(epsilon * omega)
    M = M.at[5,1].set(eta * omega)
    M = M.at[5,4].set(eta)
    M = M.at[5,6].set(beta)
    M = M.at[5,7].set(delta)
    M = M.at[5,9].set(beta * omega)
    M = M.at[5,11].set(delta * omega)
    M = M.at[5,18].set(eta * omega)
    M = M.at[5,34].set(gamma * omega)
    M = M.at[5,50].set(epsilon * omega)
    M = M.at[6,2].set(eta * omega)
    M = M.at[6,4].set(gamma)
    M = M.at[6,5].set(beta)
    M = M.at[6,7].set(alpha)
    M = M.at[6,19].set(eta * omega)
    M = M.at[6,35].set(gamma * omega)
    M = M.at[6,51].set(epsilon * omega)
    M = M.at[7,3].set(eta * omega)
    M = M.at[7,4].set(epsilon)
    M = M.at[7,5].set(delta)
    M = M.at[7,6].set(alpha)
    M = M.at[7,12].set(delta * omega)
    M = M.at[7,20].set(eta * omega)
    M = M.at[7,36].set(gamma * omega)
    M = M.at[7,52].set(epsilon * omega)
    M = M.at[8,0].set(gamma * omega)
    M = M.at[8,4].set(beta * omega)
    M = M.at[8,9].set(eta)
    M = M.at[8,10].set(alpha * omega)
    M = M.at[8,21].set(eta * omega)
    M = M.at[8,37].set(gamma * omega)
    M = M.at[8,53].set(epsilon * omega)
    M = M.at[9,1].set(gamma * omega)
    M = M.at[9,5].set(beta * omega)
    M = M.at[9,8].set(eta)
    M = M.at[9,11].set(alpha * omega)
    M = M.at[9,22].set(eta * omega)
    M = M.at[9,38].set(gamma * omega)
    M = M.at[9,54].set(epsilon * omega)
    M = M.at[10,0].set(epsilon * omega)
    M = M.at[10,4].set(delta * omega)
    M = M.at[10,8].set(alpha * omega)
    M = M.at[10,11].set(eta)
    M = M.at[10,12].set(epsilon * omega)
    M = M.at[10,25].set(eta * omega)
    M = M.at[10,41].set(gamma * omega)
    M = M.at[10,57].set(epsilon * omega)
    M = M.at[11,1].set(epsilon * omega)
    M = M.at[11,5].set(delta * omega)
    M = M.at[11,9].set(alpha * omega)
    M = M.at[11,10].set(eta)
    M = M.at[11,12].set(delta * omega)
    M = M.at[11,26].set(eta * omega)
    M = M.at[11,42].set(gamma * omega)
    M = M.at[11,58].set(epsilon * omega)
    M = M.at[12,3].set(epsilon * omega)
    M = M.at[12,7].set(delta * omega)
    M = M.at[12,10].set(epsilon * omega)
    M = M.at[12,11].set(delta * omega)
    M = M.at[12,28].set(eta * omega)
    M = M.at[12,44].set(gamma * omega)
    M = M.at[12,60].set(epsilon * omega)
    M = M.at[13,0].set(eta * omega)
    M = M.at[13,14].set(eta)
    M = M.at[13,15].set(gamma)
    M = M.at[13,16].set(epsilon)
    M = M.at[13,17].set(eta * omega)
    M = M.at[13,21].set(gamma * omega)
    M = M.at[13,25].set(epsilon * omega)
    M = M.at[13,29].set(beta * omega)
    M = M.at[13,45].set(delta * omega)
    M = M.at[14,1].set(eta * omega)
    M = M.at[14,13].set(eta)
    M = M.at[14,15].set(beta)
    M = M.at[14,16].set(delta)
    M = M.at[14,18].set(eta * omega)
    M = M.at[14,22].set(gamma * omega)
    M = M.at[14,26].set(epsilon * omega)
    M = M.at[14,30].set(beta * omega)
    M = M.at[14,46].set(delta * omega)
    M = M.at[15,2].set(eta)
    M = M.at[15,13].set(gamma)
    M = M.at[15,14].set(beta)
    M = M.at[15,16].set(alpha)
    M = M.at[15,19].set(eta * omega)
    M = M.at[15,23].set(gamma * omega)
    M = M.at[15,27].set(epsilon * omega)
    M = M.at[15,31].set(beta * omega)
    M = M.at[15,47].set(delta * omega)
    M = M.at[16,3].set(eta)
    M = M.at[16,13].set(epsilon)
    M = M.at[16,14].set(delta)
    M = M.at[16,15].set(alpha)
    M = M.at[16,20].set(eta * omega)
    M = M.at[16,24].set(gamma * omega)
    M = M.at[16,28].set(epsilon * omega)
    M = M.at[16,32].set(beta * omega)
    M = M.at[16,48].set(delta * omega)
    M = M.at[17,4].set(eta * omega)
    M = M.at[17,13].set(eta * omega)
    M = M.at[17,18].set(eta)
    M = M.at[17,19].set(gamma)
    M = M.at[17,20].set(epsilon)
    M = M.at[17,21].set(beta * omega)
    M = M.at[17,25].set(delta * omega)
    M = M.at[17,33].set(beta * omega)
    M = M.at[17,49].set(delta * omega)
    M = M.at[18,5].set(eta * omega)
    M = M.at[18,14].set(eta * omega)
    M = M.at[18,17].set(eta)
    M = M.at[18,19].set(beta)
    M = M.at[18,20].set(delta)
    M = M.at[18,22].set(beta * omega)
    M = M.at[18,26].set(delta * omega)
    M = M.at[18,34].set(beta * omega)
    M = M.at[18,50].set(delta * omega)
    M = M.at[19,6].set(eta * omega)
    M = M.at[19,15].set(eta * omega)
    M = M.at[19,17].set(gamma)
    M = M.at[19,18].set(beta)
    M = M.at[19,20].set(alpha)
    M = M.at[19,23].set(beta * omega)
    M = M.at[19,27].set(delta * omega)
    M = M.at[19,35].set(beta * omega)
    M = M.at[19,51].set(delta * omega)
    M = M.at[20,7].set(eta * omega)
    M = M.at[20,16].set(eta * omega)
    M = M.at[20,17].set(epsilon)
    M = M.at[20,18].set(delta)
    M = M.at[20,19].set(alpha)
    M = M.at[20,24].set(beta * omega)
    M = M.at[20,28].set(delta * omega)
    M = M.at[20,36].set(beta * omega)
    M = M.at[20,52].set(delta * omega)
    M = M.at[21,8].set(eta * omega)
    M = M.at[21,13].set(gamma * omega)
    M = M.at[21,17].set(beta * omega)
    M = M.at[21,22].set(eta)
    M = M.at[21,23].set(gamma * omega)
    M = M.at[21,24].set(epsilon * omega)
    M = M.at[21,25].set(alpha * omega)
    M = M.at[21,37].set(beta * omega)
    M = M.at[21,53].set(delta * omega)
    M = M.at[22,9].set(eta * omega)
    M = M.at[22,14].set(gamma * omega)
    M = M.at[22,18].set(beta * omega)
    M = M.at[22,21].set(eta)
    M = M.at[22,23].set(beta * omega)
    M = M.at[22,24].set(delta * omega)
    M = M.at[22,26].set(alpha * omega)
    M = M.at[22,38].set(beta * omega)
    M = M.at[22,54].set(delta * omega)
    M = M.at[23,15].set(gamma * omega)
    M = M.at[23,19].set(beta * omega)
    M = M.at[23,21].set(gamma * omega)
    M = M.at[23,22].set(beta * omega)
    M = M.at[23,24].set(alpha)
    M = M.at[23,27].set(alpha * omega)
    M = M.at[23,39].set(beta * omega)
    M = M.at[23,55].set(delta * omega)
    M = M.at[24,16].set(gamma * omega)
    M = M.at[24,20].set(beta * omega)
    M = M.at[24,21].set(epsilon * omega)
    M = M.at[24,22].set(delta * omega)
    M = M.at[24,23].set(alpha)
    M = M.at[24,28].set(alpha * omega)
    M = M.at[24,40].set(beta * omega)
    M = M.at[24,56].set(delta * omega)
    M = M.at[25,10].set(eta * omega)
    M = M.at[25,13].set(epsilon * omega)
    M = M.at[25,17].set(delta * omega)
    M = M.at[25,21].set(alpha * omega)
    M = M.at[25,26].set(eta)
    M = M.at[25,27].set(gamma)
    M = M.at[25,28].set(epsilon)
    M = M.at[25,41].set(beta * omega)
    M = M.at[25,57].set(delta * omega)
    M = M.at[26,11].set(eta * omega)
    M = M.at[26,14].set(epsilon * omega)
    M = M.at[26,18].set(delta * omega)
    M = M.at[26,22].set(alpha * omega)
    M = M.at[26,25].set(eta)
    M = M.at[26,27].set(beta)
    M = M.at[26,28].set(delta)
    M = M.at[26,42].set(beta * omega)
    M = M.at[26,58].set(delta * omega)
    M = M.at[27,15].set(epsilon * omega)
    M = M.at[27,19].set(delta * omega)
    M = M.at[27,23].set(alpha * omega)
    M = M.at[27,25].set(gamma)
    M = M.at[27,26].set(beta)
    M = M.at[27,28].set(alpha)
    M = M.at[27,43].set(beta)
    M = M.at[27,59].set(delta * omega)
    M = M.at[28,12].set(eta * omega)
    M = M.at[28,16].set(epsilon * omega)
    M = M.at[28,20].set(delta * omega)
    M = M.at[28,24].set(alpha * omega)
    M = M.at[28,25].set(epsilon)
    M = M.at[28,26].set(delta)
    M = M.at[28,27].set(alpha)
    M = M.at[28,44].set(beta)
    M = M.at[28,60].set(delta * omega)
    M = M.at[29,0].set(gamma * omega)
    M = M.at[29,13].set(beta * omega)
    M = M.at[29,30].set(eta)
    M = M.at[29,31].set(gamma)
    M = M.at[29,32].set(epsilon * omega)
    M = M.at[29,33].set(eta * omega)
    M = M.at[29,37].set(gamma * omega)
    M = M.at[29,41].set(epsilon * omega)
    M = M.at[29,45].set(alpha * omega)
    M = M.at[30,1].set(gamma * omega)
    M = M.at[30,14].set(beta * omega)
    M = M.at[30,29].set(eta)
    M = M.at[30,31].set(beta)
    M = M.at[30,32].set(delta * omega)
    M = M.at[30,34].set(eta * omega)
    M = M.at[30,38].set(gamma * omega)
    M = M.at[30,42].set(epsilon * omega)
    M = M.at[30,46].set(alpha * omega)
    M = M.at[31,2].set(gamma * omega)
    M = M.at[31,15].set(beta * omega)
    M = M.at[31,29].set(gamma)
    M = M.at[31,30].set(beta)
    M = M.at[31,32].set(alpha * omega)
    M = M.at[31,35].set(eta * omega)
    M = M.at[31,39].set(gamma * omega)
    M = M.at[31,43].set(epsilon * omega)
    M = M.at[31,47].set(alpha * omega)
    M = M.at[32,3].set(gamma * omega)
    M = M.at[32,16].set(beta * omega)
    M = M.at[32,29].set(epsilon * omega)
    M = M.at[32,30].set(delta * omega)
    M = M.at[32,31].set(alpha * omega)
    M = M.at[32,36].set(eta * omega)
    M = M.at[32,40].set(gamma * omega)
    M = M.at[32,44].set(epsilon * omega)
    M = M.at[32,48].set(alpha * omega)
    M = M.at[33,4].set(gamma * omega)
    M = M.at[33,17].set(beta * omega)
    M = M.at[33,29].set(eta * omega)
    M = M.at[33,34].set(eta)
    M = M.at[33,35].set(gamma)
    M = M.at[33,36].set(epsilon)
    M = M.at[33,37].set(beta * omega)
    M = M.at[33,41].set(delta * omega)
    M = M.at[33,49].set(alpha * omega)
    M = M.at[34,5].set(gamma * omega)
    M = M.at[34,18].set(beta * omega)
    M = M.at[34,30].set(eta * omega)
    M = M.at[34,33].set(eta)
    M = M.at[34,35].set(beta)
    M = M.at[34,36].set(delta)
    M = M.at[34,38].set(beta * omega)
    M = M.at[34,42].set(delta * omega)
    M = M.at[34,50].set(alpha * omega)
    M = M.at[35,6].set(gamma * omega)
    M = M.at[35,19].set(beta * omega)
    M = M.at[35,31].set(eta * omega)
    M = M.at[35,33].set(gamma)
    M = M.at[35,34].set(beta)
    M = M.at[35,36].set(alpha)
    M = M.at[35,39].set(beta * omega)
    M = M.at[35,43].set(delta * omega)
    M = M.at[35,51].set(alpha * omega)
    M = M.at[36,7].set(gamma * omega)
    M = M.at[36,20].set(beta * omega)
    M = M.at[36,32].set(eta * omega)
    M = M.at[36,33].set(epsilon)
    M = M.at[36,34].set(delta)
    M = M.at[36,35].set(alpha)
    M = M.at[36,40].set(beta * omega)
    M = M.at[36,44].set(delta * omega)
    M = M.at[36,52].set(alpha * omega)
    M = M.at[37,8].set(gamma * omega)
    M = M.at[37,21].set(beta * omega)
    M = M.at[37,29].set(gamma * omega)
    M = M.at[37,33].set(beta * omega)
    M = M.at[37,38].set(eta)
    M = M.at[37,39].set(gamma * omega)
    M = M.at[37,40].set(epsilon * omega)
    M = M.at[37,41].set(alpha * omega)
    M = M.at[37,53].set(alpha * omega)
    M = M.at[38,9].set(gamma * omega)
    M = M.at[38,22].set(beta * omega)
    M = M.at[38,30].set(gamma * omega)
    M = M.at[38,34].set(beta * omega)
    M = M.at[38,37].set(eta)
    M = M.at[38,39].set(beta * omega)
    M = M.at[38,40].set(delta * omega)
    M = M.at[38,42].set(alpha * omega)
    M = M.at[38,54].set(alpha * omega)
    M = M.at[39,23].set(beta * omega)
    M = M.at[39,31].set(gamma * omega)
    M = M.at[39,35].set(beta * omega)
    M = M.at[39,37].set(gamma * omega)
    M = M.at[39,38].set(beta * omega)
    M = M.at[39,40].set(alpha)
    M = M.at[39,43].set(alpha * omega)
    M = M.at[39,55].set(alpha * omega)
    M = M.at[40,24].set(beta * omega)
    M = M.at[40,32].set(gamma * omega)
    M = M.at[40,36].set(beta * omega)
    M = M.at[40,37].set(epsilon * omega)
    M = M.at[40,38].set(delta * omega)
    M = M.at[40,39].set(alpha)
    M = M.at[40,44].set(alpha * omega)
    M = M.at[40,56].set(alpha * omega)
    M = M.at[41,10].set(gamma * omega)
    M = M.at[41,25].set(beta * omega)
    M = M.at[41,29].set(epsilon * omega)
    M = M.at[41,33].set(delta * omega)
    M = M.at[41,37].set(alpha * omega)
    M = M.at[41,42].set(eta)
    M = M.at[41,43].set(gamma * omega)
    M = M.at[41,44].set(epsilon * omega)
    M = M.at[41,57].set(alpha * omega)
    M = M.at[42,11].set(gamma * omega)
    M = M.at[42,26].set(beta * omega)
    M = M.at[42,30].set(epsilon * omega)
    M = M.at[42,34].set(delta * omega)
    M = M.at[42,38].set(alpha * omega)
    M = M.at[42,41].set(eta)
    M = M.at[42,43].set(beta * omega)
    M = M.at[42,44].set(delta * omega)
    M = M.at[42,58].set(alpha * omega)
    M = M.at[43,27].set(beta)
    M = M.at[43,31].set(epsilon * omega)
    M = M.at[43,35].set(delta * omega)
    M = M.at[43,39].set(alpha * omega)
    M = M.at[43,41].set(gamma * omega)
    M = M.at[43,42].set(beta * omega)
    M = M.at[43,44].set(alpha)
    M = M.at[43,59].set(alpha * omega)
    M = M.at[44,12].set(gamma * omega)
    M = M.at[44,28].set(beta)
    M = M.at[44,32].set(epsilon * omega)
    M = M.at[44,36].set(delta * omega)
    M = M.at[44,40].set(alpha * omega)
    M = M.at[44,41].set(epsilon * omega)
    M = M.at[44,42].set(delta * omega)
    M = M.at[44,43].set(alpha)
    M = M.at[44,60].set(alpha * omega)
    M = M.at[45,0].set(epsilon * omega)
    M = M.at[45,13].set(delta * omega)
    M = M.at[45,29].set(alpha * omega)
    M = M.at[45,46].set(eta)
    M = M.at[45,47].set(gamma)
    M = M.at[45,48].set(epsilon)
    M = M.at[45,49].set(eta * omega)
    M = M.at[45,53].set(gamma * omega)
    M = M.at[45,57].set(epsilon * omega)
    M = M.at[46,1].set(epsilon * omega)
    M = M.at[46,14].set(delta * omega)
    M = M.at[46,30].set(alpha * omega)
    M = M.at[46,45].set(eta)
    M = M.at[46,47].set(beta)
    M = M.at[46,48].set(delta)
    M = M.at[46,50].set(eta * omega)
    M = M.at[46,54].set(gamma * omega)
    M = M.at[46,58].set(epsilon * omega)
    M = M.at[47,2].set(epsilon * omega)
    M = M.at[47,15].set(delta * omega)
    M = M.at[47,31].set(alpha * omega)
    M = M.at[47,45].set(gamma)
    M = M.at[47,46].set(beta)
    M = M.at[47,48].set(alpha)
    M = M.at[47,51].set(eta * omega)
    M = M.at[47,55].set(gamma * omega)
    M = M.at[47,59].set(epsilon * omega)
    M = M.at[48,3].set(epsilon * omega)
    M = M.at[48,16].set(delta * omega)
    M = M.at[48,32].set(alpha * omega)
    M = M.at[48,45].set(epsilon)
    M = M.at[48,46].set(delta)
    M = M.at[48,47].set(alpha)
    M = M.at[48,52].set(eta * omega)
    M = M.at[48,56].set(gamma * omega)
    M = M.at[48,60].set(epsilon * omega)
    M = M.at[49,4].set(epsilon * omega)
    M = M.at[49,17].set(delta * omega)
    M = M.at[49,33].set(alpha * omega)
    M = M.at[49,45].set(eta * omega)
    M = M.at[49,50].set(eta)
    M = M.at[49,51].set(gamma)
    M = M.at[49,52].set(epsilon)
    M = M.at[49,53].set(beta * omega)
    M = M.at[49,57].set(delta * omega)
    M = M.at[50,5].set(epsilon * omega)
    M = M.at[50,18].set(delta * omega)
    M = M.at[50,34].set(alpha * omega)
    M = M.at[50,46].set(eta * omega)
    M = M.at[50,49].set(eta)
    M = M.at[50,51].set(beta)
    M = M.at[50,52].set(delta)
    M = M.at[50,54].set(beta * omega)
    M = M.at[50,58].set(delta * omega)
    M = M.at[51,6].set(epsilon * omega)
    M = M.at[51,19].set(delta * omega)
    M = M.at[51,35].set(alpha * omega)
    M = M.at[51,47].set(eta * omega)
    M = M.at[51,49].set(gamma)
    M = M.at[51,50].set(beta)
    M = M.at[51,52].set(alpha)
    M = M.at[51,55].set(beta * omega)
    M = M.at[51,59].set(delta * omega)
    M = M.at[52,7].set(epsilon * omega)
    M = M.at[52,20].set(delta * omega)
    M = M.at[52,36].set(alpha * omega)
    M = M.at[52,48].set(eta * omega)
    M = M.at[52,49].set(epsilon)
    M = M.at[52,50].set(delta)
    M = M.at[52,51].set(alpha)
    M = M.at[52,56].set(beta * omega)
    M = M.at[52,60].set(delta * omega)
    M = M.at[53,8].set(epsilon * omega)
    M = M.at[53,21].set(delta * omega)
    M = M.at[53,37].set(alpha * omega)
    M = M.at[53,45].set(gamma * omega)
    M = M.at[53,49].set(beta * omega)
    M = M.at[53,54].set(eta)
    M = M.at[53,55].set(gamma * omega)
    M = M.at[53,56].set(epsilon * omega)
    M = M.at[53,57].set(alpha * omega)
    M = M.at[54,9].set(epsilon * omega)
    M = M.at[54,22].set(delta * omega)
    M = M.at[54,38].set(alpha * omega)
    M = M.at[54,46].set(gamma * omega)
    M = M.at[54,50].set(beta * omega)
    M = M.at[54,53].set(eta)
    M = M.at[54,55].set(beta * omega)
    M = M.at[54,56].set(delta * omega)
    M = M.at[54,58].set(alpha * omega)
    M = M.at[55,23].set(delta * omega)
    M = M.at[55,39].set(alpha * omega)
    M = M.at[55,47].set(gamma * omega)
    M = M.at[55,51].set(beta * omega)
    M = M.at[55,53].set(gamma * omega)
    M = M.at[55,54].set(beta * omega)
    M = M.at[55,56].set(alpha)
    M = M.at[55,59].set(alpha * omega)
    M = M.at[56,24].set(delta * omega)
    M = M.at[56,40].set(alpha * omega)
    M = M.at[56,48].set(gamma * omega)
    M = M.at[56,52].set(beta * omega)
    M = M.at[56,53].set(epsilon * omega)
    M = M.at[56,54].set(delta * omega)
    M = M.at[56,55].set(alpha)
    M = M.at[56,60].set(alpha * omega)
    M = M.at[57,10].set(epsilon * omega)
    M = M.at[57,25].set(delta * omega)
    M = M.at[57,41].set(alpha * omega)
    M = M.at[57,45].set(epsilon * omega)
    M = M.at[57,49].set(delta * omega)
    M = M.at[57,53].set(alpha * omega)
    M = M.at[57,58].set(eta)
    M = M.at[57,59].set(gamma)
    M = M.at[57,60].set(epsilon)
    M = M.at[58,11].set(epsilon * omega)
    M = M.at[58,26].set(delta * omega)
    M = M.at[58,42].set(alpha * omega)
    M = M.at[58,46].set(epsilon * omega)
    M = M.at[58,50].set(delta * omega)
    M = M.at[58,54].set(alpha * omega)
    M = M.at[58,57].set(eta)
    M = M.at[58,59].set(beta)
    M = M.at[58,60].set(delta)
    M = M.at[59,27].set(delta * omega)
    M = M.at[59,43].set(alpha * omega)
    M = M.at[59,47].set(epsilon * omega)
    M = M.at[59,51].set(delta * omega)
    M = M.at[59,55].set(alpha * omega)
    M = M.at[59,57].set(gamma)
    M = M.at[59,58].set(beta)
    M = M.at[59,60].set(alpha)
    M = M.at[60,12].set(epsilon * omega)
    M = M.at[60,28].set(delta * omega)
    M = M.at[60,44].set(alpha * omega)
    M = M.at[60,48].set(epsilon * omega)
    M = M.at[60,52].set(delta * omega)
    M = M.at[60,56].set(alpha * omega)
    M = M.at[60,57].set(epsilon)
    M = M.at[60,58].set(delta)
    M = M.at[60,59].set(alpha)

    M = jnp.matmul(jnp.matmul(M, pimat).T, pimat).T
    M = diag_update(M, pimult)

    return M

@jit
def update_GTR(M, omega, pimult):
    # wasteful but 'neat'?
    # M = jnp.multiply(M, jnp.multiply(omega_mat, omega) + non_omega_mat)

    Mout = M.copy()
    Mout = Mout.at[0,2].multiply(omega)
    Mout = Mout.at[0,3].multiply(omega)
    Mout = Mout.at[0,4].multiply(omega)
    Mout = Mout.at[0,8].multiply(omega)
    Mout = Mout.at[0,10].multiply(omega)
    Mout = Mout.at[0,13].multiply(omega)
    Mout = Mout.at[0,29].multiply(omega)
    Mout = Mout.at[0,45].multiply(omega)
    Mout = Mout.at[1,2].multiply(omega)
    Mout = Mout.at[1,3].multiply(omega)
    Mout = Mout.at[1,5].multiply(omega)
    Mout = Mout.at[1,9].multiply(omega)
    Mout = Mout.at[1,11].multiply(omega)
    Mout = Mout.at[1,14].multiply(omega)
    Mout = Mout.at[1,30].multiply(omega)
    Mout = Mout.at[1,46].multiply(omega)
    Mout = Mout.at[2,0].multiply(omega)
    Mout = Mout.at[2,1].multiply(omega)
    Mout = Mout.at[2,6].multiply(omega)
    Mout = Mout.at[2,31].multiply(omega)
    Mout = Mout.at[2,47].multiply(omega)
    Mout = Mout.at[3,0].multiply(omega)
    Mout = Mout.at[3,1].multiply(omega)
    Mout = Mout.at[3,7].multiply(omega)
    Mout = Mout.at[3,12].multiply(omega)
    Mout = Mout.at[3,32].multiply(omega)
    Mout = Mout.at[3,48].multiply(omega)
    Mout = Mout.at[4,0].multiply(omega)
    Mout = Mout.at[4,8].multiply(omega)
    Mout = Mout.at[4,10].multiply(omega)
    Mout = Mout.at[4,17].multiply(omega)
    Mout = Mout.at[4,33].multiply(omega)
    Mout = Mout.at[4,49].multiply(omega)
    Mout = Mout.at[5,1].multiply(omega)
    Mout = Mout.at[5,9].multiply(omega)
    Mout = Mout.at[5,11].multiply(omega)
    Mout = Mout.at[5,18].multiply(omega)
    Mout = Mout.at[5,34].multiply(omega)
    Mout = Mout.at[5,50].multiply(omega)
    Mout = Mout.at[6,2].multiply(omega)
    Mout = Mout.at[6,19].multiply(omega)
    Mout = Mout.at[6,35].multiply(omega)
    Mout = Mout.at[6,51].multiply(omega)
    Mout = Mout.at[7,3].multiply(omega)
    Mout = Mout.at[7,12].multiply(omega)
    Mout = Mout.at[7,20].multiply(omega)
    Mout = Mout.at[7,36].multiply(omega)
    Mout = Mout.at[7,52].multiply(omega)
    Mout = Mout.at[8,0].multiply(omega)
    Mout = Mout.at[8,4].multiply(omega)
    Mout = Mout.at[8,10].multiply(omega)
    Mout = Mout.at[8,21].multiply(omega)
    Mout = Mout.at[8,37].multiply(omega)
    Mout = Mout.at[8,53].multiply(omega)
    Mout = Mout.at[9,1].multiply(omega)
    Mout = Mout.at[9,5].multiply(omega)
    Mout = Mout.at[9,11].multiply(omega)
    Mout = Mout.at[9,22].multiply(omega)
    Mout = Mout.at[9,38].multiply(omega)
    Mout = Mout.at[9,54].multiply(omega)
    Mout = Mout.at[10,0].multiply(omega)
    Mout = Mout.at[10,4].multiply(omega)
    Mout = Mout.at[10,8].multiply(omega)
    Mout = Mout.at[10,12].multiply(omega)
    Mout = Mout.at[10,25].multiply(omega)
    Mout = Mout.at[10,41].multiply(omega)
    Mout = Mout.at[10,57].multiply(omega)
    Mout = Mout.at[11,1].multiply(omega)
    Mout = Mout.at[11,5].multiply(omega)
    Mout = Mout.at[11,9].multiply(omega)
    Mout = Mout.at[11,12].multiply(omega)
    Mout = Mout.at[11,26].multiply(omega)
    Mout = Mout.at[11,42].multiply(omega)
    Mout = Mout.at[11,58].multiply(omega)
    Mout = Mout.at[12,3].multiply(omega)
    Mout = Mout.at[12,7].multiply(omega)
    Mout = Mout.at[12,10].multiply(omega)
    Mout = Mout.at[12,11].multiply(omega)
    Mout = Mout.at[12,28].multiply(omega)
    Mout = Mout.at[12,44].multiply(omega)
    Mout = Mout.at[12,60].multiply(omega)
    Mout = Mout.at[13,0].multiply(omega)
    Mout = Mout.at[13,17].multiply(omega)
    Mout = Mout.at[13,21].multiply(omega)
    Mout = Mout.at[13,25].multiply(omega)
    Mout = Mout.at[13,29].multiply(omega)
    Mout = Mout.at[13,45].multiply(omega)
    Mout = Mout.at[14,1].multiply(omega)
    Mout = Mout.at[14,18].multiply(omega)
    Mout = Mout.at[14,22].multiply(omega)
    Mout = Mout.at[14,26].multiply(omega)
    Mout = Mout.at[14,30].multiply(omega)
    Mout = Mout.at[14,46].multiply(omega)
    Mout = Mout.at[15,19].multiply(omega)
    Mout = Mout.at[15,23].multiply(omega)
    Mout = Mout.at[15,27].multiply(omega)
    Mout = Mout.at[15,31].multiply(omega)
    Mout = Mout.at[15,47].multiply(omega)
    Mout = Mout.at[16,20].multiply(omega)
    Mout = Mout.at[16,24].multiply(omega)
    Mout = Mout.at[16,28].multiply(omega)
    Mout = Mout.at[16,32].multiply(omega)
    Mout = Mout.at[16,48].multiply(omega)
    Mout = Mout.at[17,4].multiply(omega)
    Mout = Mout.at[17,13].multiply(omega)
    Mout = Mout.at[17,21].multiply(omega)
    Mout = Mout.at[17,25].multiply(omega)
    Mout = Mout.at[17,33].multiply(omega)
    Mout = Mout.at[17,49].multiply(omega)
    Mout = Mout.at[18,5].multiply(omega)
    Mout = Mout.at[18,14].multiply(omega)
    Mout = Mout.at[18,22].multiply(omega)
    Mout = Mout.at[18,26].multiply(omega)
    Mout = Mout.at[18,34].multiply(omega)
    Mout = Mout.at[18,50].multiply(omega)
    Mout = Mout.at[19,6].multiply(omega)
    Mout = Mout.at[19,15].multiply(omega)
    Mout = Mout.at[19,23].multiply(omega)
    Mout = Mout.at[19,27].multiply(omega)
    Mout = Mout.at[19,35].multiply(omega)
    Mout = Mout.at[19,51].multiply(omega)
    Mout = Mout.at[20,7].multiply(omega)
    Mout = Mout.at[20,16].multiply(omega)
    Mout = Mout.at[20,24].multiply(omega)
    Mout = Mout.at[20,28].multiply(omega)
    Mout = Mout.at[20,36].multiply(omega)
    Mout = Mout.at[20,52].multiply(omega)
    Mout = Mout.at[21,8].multiply(omega)
    Mout = Mout.at[21,13].multiply(omega)
    Mout = Mout.at[21,17].multiply(omega)
    Mout = Mout.at[21,23].multiply(omega)
    Mout = Mout.at[21,24].multiply(omega)
    Mout = Mout.at[21,25].multiply(omega)
    Mout = Mout.at[21,37].multiply(omega)
    Mout = Mout.at[21,53].multiply(omega)
    Mout = Mout.at[22,9].multiply(omega)
    Mout = Mout.at[22,14].multiply(omega)
    Mout = Mout.at[22,18].multiply(omega)
    Mout = Mout.at[22,23].multiply(omega)
    Mout = Mout.at[22,24].multiply(omega)
    Mout = Mout.at[22,26].multiply(omega)
    Mout = Mout.at[22,38].multiply(omega)
    Mout = Mout.at[22,54].multiply(omega)
    Mout = Mout.at[23,15].multiply(omega)
    Mout = Mout.at[23,19].multiply(omega)
    Mout = Mout.at[23,21].multiply(omega)
    Mout = Mout.at[23,22].multiply(omega)
    Mout = Mout.at[23,27].multiply(omega)
    Mout = Mout.at[23,39].multiply(omega)
    Mout = Mout.at[23,55].multiply(omega)
    Mout = Mout.at[24,16].multiply(omega)
    Mout = Mout.at[24,20].multiply(omega)
    Mout = Mout.at[24,21].multiply(omega)
    Mout = Mout.at[24,22].multiply(omega)
    Mout = Mout.at[24,28].multiply(omega)
    Mout = Mout.at[24,40].multiply(omega)
    Mout = Mout.at[24,56].multiply(omega)
    Mout = Mout.at[25,10].multiply(omega)
    Mout = Mout.at[25,13].multiply(omega)
    Mout = Mout.at[25,17].multiply(omega)
    Mout = Mout.at[25,21].multiply(omega)
    Mout = Mout.at[25,41].multiply(omega)
    Mout = Mout.at[25,57].multiply(omega)
    Mout = Mout.at[26,11].multiply(omega)
    Mout = Mout.at[26,14].multiply(omega)
    Mout = Mout.at[26,18].multiply(omega)
    Mout = Mout.at[26,22].multiply(omega)
    Mout = Mout.at[26,42].multiply(omega)
    Mout = Mout.at[26,58].multiply(omega)
    Mout = Mout.at[27,15].multiply(omega)
    Mout = Mout.at[27,19].multiply(omega)
    Mout = Mout.at[27,23].multiply(omega)
    Mout = Mout.at[27,59].multiply(omega)
    Mout = Mout.at[28,12].multiply(omega)
    Mout = Mout.at[28,16].multiply(omega)
    Mout = Mout.at[28,20].multiply(omega)
    Mout = Mout.at[28,24].multiply(omega)
    Mout = Mout.at[28,60].multiply(omega)
    Mout = Mout.at[29,0].multiply(omega)
    Mout = Mout.at[29,13].multiply(omega)
    Mout = Mout.at[29,32].multiply(omega)
    Mout = Mout.at[29,33].multiply(omega)
    Mout = Mout.at[29,37].multiply(omega)
    Mout = Mout.at[29,41].multiply(omega)
    Mout = Mout.at[29,45].multiply(omega)
    Mout = Mout.at[30,1].multiply(omega)
    Mout = Mout.at[30,14].multiply(omega)
    Mout = Mout.at[30,32].multiply(omega)
    Mout = Mout.at[30,34].multiply(omega)
    Mout = Mout.at[30,38].multiply(omega)
    Mout = Mout.at[30,42].multiply(omega)
    Mout = Mout.at[30,46].multiply(omega)
    Mout = Mout.at[31,2].multiply(omega)
    Mout = Mout.at[31,15].multiply(omega)
    Mout = Mout.at[31,32].multiply(omega)
    Mout = Mout.at[31,35].multiply(omega)
    Mout = Mout.at[31,39].multiply(omega)
    Mout = Mout.at[31,43].multiply(omega)
    Mout = Mout.at[31,47].multiply(omega)
    Mout = Mout.at[32,3].multiply(omega)
    Mout = Mout.at[32,16].multiply(omega)
    Mout = Mout.at[32,29].multiply(omega)
    Mout = Mout.at[32,30].multiply(omega)
    Mout = Mout.at[32,31].multiply(omega)
    Mout = Mout.at[32,36].multiply(omega)
    Mout = Mout.at[32,40].multiply(omega)
    Mout = Mout.at[32,44].multiply(omega)
    Mout = Mout.at[32,48].multiply(omega)
    Mout = Mout.at[33,4].multiply(omega)
    Mout = Mout.at[33,17].multiply(omega)
    Mout = Mout.at[33,29].multiply(omega)
    Mout = Mout.at[33,37].multiply(omega)
    Mout = Mout.at[33,41].multiply(omega)
    Mout = Mout.at[33,49].multiply(omega)
    Mout = Mout.at[34,5].multiply(omega)
    Mout = Mout.at[34,18].multiply(omega)
    Mout = Mout.at[34,30].multiply(omega)
    Mout = Mout.at[34,38].multiply(omega)
    Mout = Mout.at[34,42].multiply(omega)
    Mout = Mout.at[34,50].multiply(omega)
    Mout = Mout.at[35,6].multiply(omega)
    Mout = Mout.at[35,19].multiply(omega)
    Mout = Mout.at[35,31].multiply(omega)
    Mout = Mout.at[35,39].multiply(omega)
    Mout = Mout.at[35,43].multiply(omega)
    Mout = Mout.at[35,51].multiply(omega)
    Mout = Mout.at[36,7].multiply(omega)
    Mout = Mout.at[36,20].multiply(omega)
    Mout = Mout.at[36,32].multiply(omega)
    Mout = Mout.at[36,40].multiply(omega)
    Mout = Mout.at[36,44].multiply(omega)
    Mout = Mout.at[36,52].multiply(omega)
    Mout = Mout.at[37,8].multiply(omega)
    Mout = Mout.at[37,21].multiply(omega)
    Mout = Mout.at[37,29].multiply(omega)
    Mout = Mout.at[37,33].multiply(omega)
    Mout = Mout.at[37,39].multiply(omega)
    Mout = Mout.at[37,40].multiply(omega)
    Mout = Mout.at[37,41].multiply(omega)
    Mout = Mout.at[37,53].multiply(omega)
    Mout = Mout.at[38,9].multiply(omega)
    Mout = Mout.at[38,22].multiply(omega)
    Mout = Mout.at[38,30].multiply(omega)
    Mout = Mout.at[38,34].multiply(omega)
    Mout = Mout.at[38,39].multiply(omega)
    Mout = Mout.at[38,40].multiply(omega)
    Mout = Mout.at[38,42].multiply(omega)
    Mout = Mout.at[38,54].multiply(omega)
    Mout = Mout.at[39,23].multiply(omega)
    Mout = Mout.at[39,31].multiply(omega)
    Mout = Mout.at[39,35].multiply(omega)
    Mout = Mout.at[39,37].multiply(omega)
    Mout = Mout.at[39,38].multiply(omega)
    Mout = Mout.at[39,43].multiply(omega)
    Mout = Mout.at[39,55].multiply(omega)
    Mout = Mout.at[40,24].multiply(omega)
    Mout = Mout.at[40,32].multiply(omega)
    Mout = Mout.at[40,36].multiply(omega)
    Mout = Mout.at[40,37].multiply(omega)
    Mout = Mout.at[40,38].multiply(omega)
    Mout = Mout.at[40,44].multiply(omega)
    Mout = Mout.at[40,56].multiply(omega)
    Mout = Mout.at[41,10].multiply(omega)
    Mout = Mout.at[41,25].multiply(omega)
    Mout = Mout.at[41,29].multiply(omega)
    Mout = Mout.at[41,33].multiply(omega)
    Mout = Mout.at[41,37].multiply(omega)
    Mout = Mout.at[41,43].multiply(omega)
    Mout = Mout.at[41,44].multiply(omega)
    Mout = Mout.at[41,57].multiply(omega)
    Mout = Mout.at[42,11].multiply(omega)
    Mout = Mout.at[42,26].multiply(omega)
    Mout = Mout.at[42,30].multiply(omega)
    Mout = Mout.at[42,34].multiply(omega)
    Mout = Mout.at[42,38].multiply(omega)
    Mout = Mout.at[42,43].multiply(omega)
    Mout = Mout.at[42,44].multiply(omega)
    Mout = Mout.at[42,58].multiply(omega)
    Mout = Mout.at[43,31].multiply(omega)
    Mout = Mout.at[43,35].multiply(omega)
    Mout = Mout.at[43,39].multiply(omega)
    Mout = Mout.at[43,41].multiply(omega)
    Mout = Mout.at[43,42].multiply(omega)
    Mout = Mout.at[43,59].multiply(omega)
    Mout = Mout.at[44,12].multiply(omega)
    Mout = Mout.at[44,32].multiply(omega)
    Mout = Mout.at[44,36].multiply(omega)
    Mout = Mout.at[44,40].multiply(omega)
    Mout = Mout.at[44,41].multiply(omega)
    Mout = Mout.at[44,42].multiply(omega)
    Mout = Mout.at[44,60].multiply(omega)
    Mout = Mout.at[45,0].multiply(omega)
    Mout = Mout.at[45,13].multiply(omega)
    Mout = Mout.at[45,29].multiply(omega)
    Mout = Mout.at[45,49].multiply(omega)
    Mout = Mout.at[45,53].multiply(omega)
    Mout = Mout.at[45,57].multiply(omega)
    Mout = Mout.at[46,1].multiply(omega)
    Mout = Mout.at[46,14].multiply(omega)
    Mout = Mout.at[46,30].multiply(omega)
    Mout = Mout.at[46,50].multiply(omega)
    Mout = Mout.at[46,54].multiply(omega)
    Mout = Mout.at[46,58].multiply(omega)
    Mout = Mout.at[47,2].multiply(omega)
    Mout = Mout.at[47,15].multiply(omega)
    Mout = Mout.at[47,31].multiply(omega)
    Mout = Mout.at[47,51].multiply(omega)
    Mout = Mout.at[47,55].multiply(omega)
    Mout = Mout.at[47,59].multiply(omega)
    Mout = Mout.at[48,3].multiply(omega)
    Mout = Mout.at[48,16].multiply(omega)
    Mout = Mout.at[48,32].multiply(omega)
    Mout = Mout.at[48,52].multiply(omega)
    Mout = Mout.at[48,56].multiply(omega)
    Mout = Mout.at[48,60].multiply(omega)
    Mout = Mout.at[49,4].multiply(omega)
    Mout = Mout.at[49,17].multiply(omega)
    Mout = Mout.at[49,33].multiply(omega)
    Mout = Mout.at[49,45].multiply(omega)
    Mout = Mout.at[49,53].multiply(omega)
    Mout = Mout.at[49,57].multiply(omega)
    Mout = Mout.at[50,5].multiply(omega)
    Mout = Mout.at[50,18].multiply(omega)
    Mout = Mout.at[50,34].multiply(omega)
    Mout = Mout.at[50,46].multiply(omega)
    Mout = Mout.at[50,54].multiply(omega)
    Mout = Mout.at[50,58].multiply(omega)
    Mout = Mout.at[51,6].multiply(omega)
    Mout = Mout.at[51,19].multiply(omega)
    Mout = Mout.at[51,35].multiply(omega)
    Mout = Mout.at[51,47].multiply(omega)
    Mout = Mout.at[51,55].multiply(omega)
    Mout = Mout.at[51,59].multiply(omega)
    Mout = Mout.at[52,7].multiply(omega)
    Mout = Mout.at[52,20].multiply(omega)
    Mout = Mout.at[52,36].multiply(omega)
    Mout = Mout.at[52,48].multiply(omega)
    Mout = Mout.at[52,56].multiply(omega)
    Mout = Mout.at[52,60].multiply(omega)
    Mout = Mout.at[53,8].multiply(omega)
    Mout = Mout.at[53,21].multiply(omega)
    Mout = Mout.at[53,37].multiply(omega)
    Mout = Mout.at[53,45].multiply(omega)
    Mout = Mout.at[53,49].multiply(omega)
    Mout = Mout.at[53,55].multiply(omega)
    Mout = Mout.at[53,56].multiply(omega)
    Mout = Mout.at[53,57].multiply(omega)
    Mout = Mout.at[54,9].multiply(omega)
    Mout = Mout.at[54,22].multiply(omega)
    Mout = Mout.at[54,38].multiply(omega)
    Mout = Mout.at[54,46].multiply(omega)
    Mout = Mout.at[54,50].multiply(omega)
    Mout = Mout.at[54,55].multiply(omega)
    Mout = Mout.at[54,56].multiply(omega)
    Mout = Mout.at[54,58].multiply(omega)
    Mout = Mout.at[55,23].multiply(omega)
    Mout = Mout.at[55,39].multiply(omega)
    Mout = Mout.at[55,47].multiply(omega)
    Mout = Mout.at[55,51].multiply(omega)
    Mout = Mout.at[55,53].multiply(omega)
    Mout = Mout.at[55,54].multiply(omega)
    Mout = Mout.at[55,59].multiply(omega)
    Mout = Mout.at[56,24].multiply(omega)
    Mout = Mout.at[56,40].multiply(omega)
    Mout = Mout.at[56,48].multiply(omega)
    Mout = Mout.at[56,52].multiply(omega)
    Mout = Mout.at[56,53].multiply(omega)
    Mout = Mout.at[56,54].multiply(omega)
    Mout = Mout.at[56,60].multiply(omega)
    Mout = Mout.at[57,10].multiply(omega)
    Mout = Mout.at[57,25].multiply(omega)
    Mout = Mout.at[57,41].multiply(omega)
    Mout = Mout.at[57,45].multiply(omega)
    Mout = Mout.at[57,49].multiply(omega)
    Mout = Mout.at[57,53].multiply(omega)
    Mout = Mout.at[58,11].multiply(omega)
    Mout = Mout.at[58,26].multiply(omega)
    Mout = Mout.at[58,42].multiply(omega)
    Mout = Mout.at[58,46].multiply(omega)
    Mout = Mout.at[58,50].multiply(omega)
    Mout = Mout.at[58,54].multiply(omega)
    Mout = Mout.at[59,27].multiply(omega)
    Mout = Mout.at[59,43].multiply(omega)
    Mout = Mout.at[59,47].multiply(omega)
    Mout = Mout.at[59,51].multiply(omega)
    Mout = Mout.at[59,55].multiply(omega)
    Mout = Mout.at[60,12].multiply(omega)
    Mout = Mout.at[60,28].multiply(omega)
    Mout = Mout.at[60,44].multiply(omega)
    Mout = Mout.at[60,48].multiply(omega)
    Mout = Mout.at[60,52].multiply(omega)
    Mout = Mout.at[60,56].multiply(omega)

    Mout = diag_update(Mout, pimult)

    return Mout
